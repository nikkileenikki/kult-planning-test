import{j as e}from"./index-C1JaId44.js";import{d as y,r as l}from"./vendor-7lAwbL4C.js";import{a as d}from"./utils-B9ygI19o.js";import{L as N}from"./Layout-BIIFe71_.js";function W(){const o=y(),[L,p]=l.useState(null),[c,u]=l.useState([]),[g,x]=l.useState(!0),[i,j]=l.useState({total:0,draft:0,pending:0,approved:0,booked:0});l.useEffect(()=>{b(),h()},[]);const b=async()=>{const t=localStorage.getItem("token");try{const s=await d.get("/api/auth/me",{headers:{Authorization:`Bearer ${t}`}});p(s.data.user)}catch(s){console.error("Failed to load user:",s),o("/login")}},h=async()=>{const t=localStorage.getItem("token");try{x(!0);const r=(await d.get("/api/campaign-workflow/my-campaigns",{headers:{Authorization:`Bearer ${t}`}})).data.campaigns||[];u(r);const a={total:r.length,draft:r.filter(n=>n.status==="draft").length,pending:r.filter(n=>n.status==="pending_approval").length,approved:r.filter(n=>n.status==="approved").length,booked:r.filter(n=>n.status==="booked").length};j(a)}catch(s){console.error("Failed to load campaigns:",s)}finally{x(!1)}},v=async t=>{const s=localStorage.getItem("token");try{await d.post(`/api/campaign-workflow/${t}/submit`,{},{headers:{Authorization:`Bearer ${s}`}}),alert("Campaign submitted for approval!"),h()}catch(r){console.error("Failed to submit campaign:",r),alert("Failed to submit campaign")}},f=t=>{const s={draft:{bg:"bg-gray-600",text:"Draft",icon:"edit"},pending_approval:{bg:"bg-yellow-600",text:"Pending Review",icon:"clock"},approved:{bg:"bg-green-600",text:"Approved",icon:"check-circle"},rejected:{bg:"bg-red-600",text:"Rejected",icon:"x-circle"},booked:{bg:"bg-blue-600",text:"Booked",icon:"calendar"},in_progress:{bg:"bg-purple-600",text:"In Progress",icon:"trending-up"},live:{bg:"bg-cyan-600",text:"Live",icon:"activity"},completed:{bg:"bg-gray-500",text:"Completed",icon:"check"}},r=n=>{const m={edit:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),clock:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"check-circle":e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"x-circle":e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),calendar:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"trending-up":e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),activity:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),check:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})};return m[n]||m.edit},a=s[t]||s.draft;return e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-semibold text-white ${a.bg} flex items-center gap-1`,children:[r(a.icon),e.jsx("span",{children:a.text})]})},k=t=>new Intl.NumberFormat("en-MY",{style:"currency",currency:"MYR",minimumFractionDigits:0}).format(t),w=t=>{const s=[];return t.status==="draft"&&(s.push(e.jsx("button",{onClick:()=>o(`/build-plan-wizard?id=${t.id}`),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-medium transition-colors",children:"âœï¸ Continue Editing"},"edit")),s.push(e.jsxs("button",{onClick:()=>v(t.id),className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 inline mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Submit for Approval"]},"submit"))),t.status==="rejected"&&s.push(e.jsx("button",{onClick:()=>o(`/build-plan-wizard?id=${t.id}`),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-medium transition-colors",children:"âœï¸ Revise & Resubmit"},"edit")),s.push(e.jsx("button",{onClick:()=>o(`/campaigns/${t.id}`),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors",children:"ðŸ‘ï¸ View Details"},"view")),s};return g?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Loading campaigns..."})]})}):e.jsx(N,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"My Campaigns"}),e.jsx("p",{className:"text-gray-400",children:"Create and manage your campaign plans"})]}),e.jsxs("button",{onClick:()=>o("/build-plan-wizard"),className:"bg-cyan-600 hover:bg-cyan-700 text-white px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Create New Campaign"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Total"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:i.total})]}),e.jsx("svg",{className:"w-8 h-8 text-cyan-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})]})}),e.jsx("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Draft"}),e.jsx("p",{className:"text-3xl font-bold text-gray-400",children:i.draft})]}),e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})]})}),e.jsx("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Pending"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-400",children:i.pending})]}),e.jsx("svg",{className:"w-8 h-8 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),e.jsx("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Approved"}),e.jsx("p",{className:"text-3xl font-bold text-green-400",children:i.approved})]}),e.jsx("svg",{className:"w-8 h-8 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),e.jsx("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Booked"}),e.jsx("p",{className:"text-3xl font-bold text-blue-400",children:i.booked})]}),e.jsx("svg",{className:"w-8 h-8 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})})]}),e.jsxs("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"All Campaigns"}),c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 text-cyan-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No campaigns yet"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Create your first campaign to get started"}),e.jsxs("button",{onClick:()=>o("/build-plan-wizard"),className:"bg-cyan-600 hover:bg-cyan-700 text-white px-6 py-3 rounded-lg font-medium transition-colors inline-flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Create Campaign"})]})]}):e.jsx("div",{className:"space-y-3",children:c.map(t=>{var s,r,a;return e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-5 hover:border-cyan-500 transition-all",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-white font-semibold text-lg",children:t.campaignName||"Untitled Campaign"}),f(t.status)]}),e.jsxs("p",{className:"text-gray-400 text-sm mb-2",children:[t.advertiserName," â€¢ ",t.objective," â€¢ ",(s=t.industry)==null?void 0:s.replace("_"," ")]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:["Budget: ",e.jsx("span",{className:"text-white font-medium",children:k(t.totalBudget||0)})]}),e.jsxs("span",{className:"text-gray-400",children:["Created: ",e.jsx("span",{className:"text-white",children:new Date(t.createdAt).toLocaleDateString()})]}),t.status==="pending_approval"&&((r=t.workflow)==null?void 0:r.submittedAt)&&e.jsxs("span",{className:"text-yellow-400",children:["Submitted: ",new Date(t.workflow.submittedAt).toLocaleDateString()]}),t.status==="rejected"&&((a=t.workflow)==null?void 0:a.rejectionReason)&&e.jsxs("span",{className:"text-red-400",children:["Reason: ",t.workflow.rejectionReason]})]})]})}),e.jsx("div",{className:"flex gap-2",children:w(t)})]},t.id)})})]}),e.jsxs("div",{className:"bg-gradient-to-r from-cyan-900/20 to-purple-900/20 border border-cyan-500/30 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-white font-semibold mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ’¡"}),e.jsx("span",{children:"Campaign Workflow"})]}),e.jsxs("div",{className:"text-gray-300 text-sm space-y-2",children:[e.jsxs("p",{children:["1. ",e.jsx("strong",{children:"Create"})," a new campaign using the wizard"]}),e.jsxs("p",{children:["2. ",e.jsx("strong",{children:"Submit"})," for approval when ready"]}),e.jsxs("p",{children:["3. ",e.jsx("strong",{children:"Client Admin"})," will review and approve/reject"]}),e.jsxs("p",{children:["4. Once approved, admin will ",e.jsx("strong",{children:"Book"})," the campaign"]}),e.jsx("p",{children:"5. Our sales team will be notified and follow up with you"})]})]})]})})}export{W as default};
