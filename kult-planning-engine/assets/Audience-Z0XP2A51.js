import{j as e}from"./index-C1JaId44.js";import{r as m,c as Ue}from"./vendor-7lAwbL4C.js";import{a as I}from"./utils-B9ygI19o.js";import{L as Xe}from"./Layout-BIIFe71_.js";function ot(){const[be,K]=m.useState(!0),[Qe,ee]=m.useState(!0),[te,se]=m.useState(!1),[ne,ve]=m.useState([]),[le,je]=m.useState([]),[ce,de]=m.useState(null),[u,G]=m.useState({personas:[],states:[]}),[L,T]=m.useState(null),[M,V]=m.useState(""),[z,we]=m.useState(""),[v,Ne]=m.useState({key:"TotalAudience",direction:"desc"}),[Je,ke]=m.useState(1),[Se,Ke]=m.useState(20),[Ae,Ce]=m.useState([]),[y,B]=m.useState([]),[W,Y]=m.useState(null),[Ee,$]=m.useState(!1),[ae,D]=m.useState([]),[O,re]=m.useState(null),[d,k]=m.useState({race:[],generation:[],income:[]}),[w,Z]=m.useState(null),Le="https://docs.google.com/spreadsheets/d/1LN4ADESlgJs-IlqUHX4z3BYxAfF1ej6JOqhLslKuQmc/edit?gid=0#gid=0",_={Entertainment:["Entertaiment","Comedy Lover","Horror","Romantic Comedy","Action & Adventure","Animation","Sci-Fi & Fantasy","Music & Concert Goers"],Sports:["Sports","EPL Super Fans","Badminton","Golf Fans","Sepak Takraw","Esports Fan"],Lifestyle:["Active Lifestyle Seekers","Adventure Enthuasiasts","Health & Wellness Shoppers","Foodies","Travel & Experience Seekers","Fashion Icons"],Technology:["Tech & Gadget Enthuasiasts","Gadget Gurus","Online Shoppers"],Automotive:["Automative Ethuasiasts","Automative Intent"],Business:["Business & Professional","Corporate Visionaries","SME","Start-ups","Emerging Affluents"],Luxury:["Luxury Buyers","Luxury Seekers"],Family:["Family Dynamic ( Experienced Family )","Little Steps Advocates ( Young Family)","Mommy Pros ( Experienced Mother)","Youth Mom","The Dynamic Duo"],"Life Stage":["Students","Young Working Adult","Soloist"],"Home & Living":["Home Buyers","Eco Enthuasiasts"]},Me={Race:["Malay","Chinese","Indian"],Income:["B40 (Bottom 40%)","M40 (Middle 40%)","T20 (Top 20%)"],Generation:["Generation Z (Gen Z)","Millennials (Gen Y)","Generation X (Gen X)","Baby Boomers"],Age:[]},oe={Race:{Malay:.697,Chinese:.228,Indian:.067,Other:.008},Generation:{"Generation Z (Gen Z)":.254,"Millennials (Gen Y)":.303,"Generation X (Gen X)":.245,"Baby Boomers":.198},Income:{"B40 (Bottom 40%)":.4,"M40 (Middle 40%)":.4,"T20 (Top 20%)":.2}},q={"Entertainment-Entertainment":.75,"Sports-Sports":.75,"Lifestyle-Lifestyle":.6,"Technology-Technology":.6,"Sports-Lifestyle":.55,"Business-Luxury":.45,"Luxury-Business":.45,"Entertainment-Technology":.3,"Technology-Entertainment":.3,"Lifestyle-Technology":.3,"Technology-Lifestyle":.3,default:.2},ue={"Comedy Lover":"Seek laughter, light-hearted entertainment, enjoy witty dialogue and humor, use comedy to unwind. They gravitate to films, stand-up, satire and social commentary.","Romantic Comedy":"Enjoy heartwarming love stories, humor, escapism and optimistic narratives about relationships across classic and modern rom-coms.",Animation:"Drawn to visually captivating storytelling, emotional depth and family-friendly content. Appreciate variety from CGI to stop-motion and family bonding via animation.","Start-ups":"Ambitious and driven individuals building ventures across diverse industries. They value brand identity, digital presence, learning and adaptability.","Emerging Affluents":"Aim to enhance lifestyle through better homes, travel and luxury. Seek balance between financial responsibility and indulgence.",Students:"Lower income group working multiple jobs, tech-savvy despite constraints. Prioritize affordability and cost-effective content and lifestyle decisions.","Young Working Adult":"Digital-native generation valuing authenticity, instant connectivity and self-expression. They are financially cautious but entrepreneurial.","Action & Adventure":"Seek thrilling and high-energy entertainment, intense storylines, immersive cinematic experiences and strong visual narratives.","Music & Concert Goers":"Value immersive live events and exclusive performances. Music is self-expression and social identity, with strong interest in VIP access and discovery.","Online Shoppers":"Use digital platforms to discover products, read reviews and compare options. Influenced by social content, influencers, and promotions.",Horror:"Follow horror media across platforms, engage in deep thematic discussions and behind-the-scenes content, and enjoy analyzing fear and symbolism.","Active Lifestyle Seekers":"Health-conscious individuals who prioritize fitness, outdoor activities and balanced living. Seek products and experiences that support active lifestyles.",Foodies:"Passionate about culinary experiences, discovering new restaurants, and exploring diverse cuisines. Share food experiences on social media.",Sports:"Avid followers of various sports, attend live events, and engage with sports content regularly. Value athletic performance and team loyalty.","EPL Super Fans":"Dedicated English Premier League followers who watch every match, follow team news, and engage in football discussions passionately.",Badminton:"Enthusiasts of badminton as players or spectators. Follow tournaments, players, and engage with badminton community.","Tech & Gadget Enthuasiasts":"Early adopters of technology, follow latest gadget releases, and value innovation. Stay updated on tech trends and reviews.","Gadget Gurus":"Expert-level technology users who deeply understand specifications, compare products, and influence others' tech purchasing decisions.","Automative Ethuasiasts":"Car enthusiasts who follow automotive news, appreciate vehicle design, performance, and enjoy driving experiences.","Automative Intent":"Active car buyers researching vehicles, comparing models, and planning automotive purchases in near future.","Business & Professional":"Career-focused professionals seeking growth, networking, and business insights. Value professional development and industry knowledge.","Corporate Visionaries":"Senior business leaders and decision-makers who drive organizational strategy, innovation, and corporate transformation.",SME:"Small and medium enterprise owners balancing multiple business roles, seeking practical solutions and growth strategies.","Luxury Buyers":"High-net-worth individuals making premium purchases, valuing exclusivity, quality craftsmanship, and prestigious brands.","Luxury Seekers":"Aspirational consumers attracted to luxury lifestyle, premium experiences, and high-end products.","Health & Wellness Shoppers":"Consumers prioritizing health products, organic options, supplements, and wellness services for better living.","Travel & Experience Seekers":"Adventure travelers seeking unique destinations, cultural experiences, and memorable journeys over material possessions.","Fashion Icons":"Style-conscious individuals following fashion trends, designer collections, and expressing identity through clothing.","Family Dynamic ( Experienced Family )":"Established families with older children, balancing multiple needs, and seeking family-oriented products and services.","Little Steps Advocates ( Young Family)":"New parents with young children, learning parenting skills, and seeking child development resources.","Mommy Pros ( Experienced Mother)":"Experienced mothers confident in parenting, sharing advice, and seeking advanced parenting solutions.","Youth Mom":"Young mothers navigating early parenthood, seeking support, community, and practical parenting guidance.","The Dynamic Duo":"Couples without children, dual-income households focusing on career, relationship, and lifestyle experiences.",Soloist:"Single individuals prioritizing personal growth, independence, and self-fulfillment in various life aspects.","Home Buyers":"Active property seekers researching real estate, comparing locations, and planning home purchases.","Eco Enthuasiasts":"Environmentally conscious consumers choosing sustainable products, supporting green initiatives, and reducing environmental impact.","Sci-Fi & Fantasy":"Fans of science fiction and fantasy genres, engaging with complex narratives, world-building, and speculative content.","Golf Fans":"Golf enthusiasts who play regularly or follow professional tournaments, appreciating the sport's strategy and tradition.","Sepak Takraw":"Fans of this Southeast Asian sport, following local tournaments and supporting national teams.","Esports Fan":"Competitive gaming enthusiasts following esports tournaments, professional players, and gaming community culture.","Adventure Enthuasiasts":"Thrill-seekers pursuing outdoor adventures, extreme sports, and challenging physical activities.",Entertaiment:"General entertainment consumers seeking diverse content across multiple platforms and genres for leisure and relaxation."};m.useEffect(()=>{xe(),Fe()},[]);const U="/api",X="1",Fe=async()=>{try{const t=await I.get(`${U}/audience-groups?userId=${X}`);t.data.success&&(D(t.data.data),console.log(`Loaded ${t.data.count} saved audience groups`))}catch(t){console.error("Error loading audience groups:",t)}},Pe=async t=>{try{const s=await I.post(`${U}/audience-groups?userId=${X}`,t);if(s.data.success)return console.log("Audience group saved:",s.data.data),s.data.data}catch(s){throw console.error("Error saving audience group:",s),s}},me=async(t,s)=>{try{const n=await I.put(`${U}/audience-groups/${t}?userId=${X}`,s);if(n.data.success)return console.log("Audience group updated:",n.data.data),n.data.data}catch(n){throw console.error("Error updating audience group:",n),n}},Ie=async t=>{try{if((await I.delete(`${U}/audience-groups/${t}?userId=${X}`)).data.success)return console.log("Audience group deleted"),!0}catch(s){throw console.error("Error deleting audience group:",s),s}};m.useEffect(()=>{ke(1)},[u]),m.useEffect(()=>{const t=s=>{L&&!s.target.closest(".relative")&&T(null)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[L]),m.useEffect(()=>{const t=s=>{w&&!s.target.closest(".demographic-filter-dropdown")&&Z(null)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[w]);const xe=async()=>{var t,s;try{K(!0),ee(!0),de(null);const n=await I.get("/api/audience");if(n.data.success){const a=n.data.data||[];ve(a),je(n.data.headers||[]),K(!1),setTimeout(()=>{ee(!1)},100)}else throw new Error("Failed to fetch audience data")}catch(n){console.error("Error fetching audience:",n),de(((s=(t=n.response)==null?void 0:t.data)==null?void 0:s.error)||"Failed to load audience data. Please try again."),K(!1),ee(!1)}finally{se(!1)}},Ge=async()=>{se(!0);try{await I.post("/api/audience/refresh"),await xe()}catch(t){console.error("Error refreshing audience:",t),se(!1)}},N=t=>{if(!t)return"0";const s=typeof t=="string"?parseInt(t.replace(/,/g,"")):t;return s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":s.toLocaleString()},ie=()=>ne.length?[...new Set(ne.map(s=>s.Personas).filter(s=>s))].sort():[],C=t=>{for(const[s,n]of Object.entries(_))if(n.includes(t))return s;return null},Te=t=>({Entertainment:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",Sports:"bg-green-500/20 text-green-400 border-green-500/30",Lifestyle:"bg-purple-500/20 text-purple-400 border-purple-500/30",Technology:"bg-blue-500/20 text-blue-400 border-blue-500/30",Automotive:"bg-orange-500/20 text-orange-400 border-orange-500/30",Business:"bg-pink-500/20 text-pink-400 border-pink-500/30",Luxury:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",Family:"bg-rose-500/20 text-rose-400 border-rose-500/30","Life Stage":"bg-indigo-500/20 text-indigo-400 border-indigo-500/30","Home & Living":"bg-emerald-500/20 text-emerald-400 border-emerald-500/30"})[t]||"bg-gray-500/20 text-gray-400 border-gray-500/30",pe=t=>({Entertainment:"text-cyan-400",Sports:"text-green-400",Lifestyle:"text-purple-400",Technology:"text-blue-400",Automotive:"text-orange-400",Business:"text-pink-400",Luxury:"text-yellow-400",Family:"text-rose-400","Life Stage":"text-indigo-400","Home & Living":"text-emerald-400"})[t]||"text-gray-400",S=()=>le.length?le.filter(t=>t!=="Personas"):[],he=(t,s)=>{G(n=>{const a=n[t];if(t==="personas"){const i=!a.includes(s);if(i){const o=Object.keys(_).find(l=>_[l].includes(s));if(o){const l=_[o],x=[...new Set([...a,s,...l])];return{...n,[t]:x}}}if(!i)return{...n,[t]:a.filter(o=>o!==s)}}const r=a.includes(s)?a.filter(i=>i!==s):[...a,s];return{...n,[t]:r}})},ge=(t,s)=>{G(n=>({...n,[t]:s}))},j=ne.filter(t=>!(u.personas.length>0&&!u.personas.includes(t.Personas))),Be=[...j].sort((t,s)=>{if(v.key==="audience"){const n=S();let a=0;n.forEach(i=>{const o=t[i];o&&typeof o=="string"?a+=parseInt(o.replace(/,/g,""))||0:typeof o=="number"&&(a+=o)});let r=0;return n.forEach(i=>{const o=s[i];o&&typeof o=="string"?r+=parseInt(o.replace(/,/g,""))||0:typeof o=="number"&&(r+=o)}),v.direction==="asc"?a-r:r-a}if(v.key==="Personas"){const n=t.Personas||"",a=s.Personas||"";return v.direction==="asc"?n.localeCompare(a):a.localeCompare(n)}return 0});(()=>{if(!j.length)return{totalPersonas:0,totalAudience:0,avgPerState:0};const t=S(),s=u.states.length>0?u.states:t;let n=0;j.forEach(r=>{s.forEach(i=>{const o=r[i],l=typeof o=="string"?parseInt(o.replace(/,/g,"")):o;n+=l||0})});const a=s.length>0?n/s.length:0;return{totalPersonas:j.length,totalAudience:n,avgPerState:Math.round(a)}})();const $e=()=>{const t=S(),s=u.states.length>0?u.states:t;return u.states.length>0?s.map(n=>{const a={state:n};return j.forEach(r=>{a[r.Personas]=r[n]}),a}):j.map(n=>{const a={Personas:n.Personas};return s.forEach(r=>{a[r]=n[r]}),a})};Math.ceil((()=>{const t=$e();return v.key?[...t].sort((s,n)=>{if(v.key==="audience"){const i=S();let o=0;i.forEach(x=>{const c=s[x];c&&typeof c=="string"?o+=parseInt(c.replace(/,/g,""))||0:typeof c=="number"&&(o+=c)});let l=0;return i.forEach(x=>{const c=n[x];c&&typeof c=="string"?l+=parseInt(c.replace(/,/g,""))||0:typeof c=="number"&&(l+=c)}),v.direction==="asc"?o-l:l-o}let a=s[v.key],r=n[v.key];return typeof a=="string"&&a.includes(",")&&(a=parseInt(a.replace(/,/g,"")),r=parseInt(r.replace(/,/g,""))),typeof a=="string"?v.direction==="asc"?a.localeCompare(r):r.localeCompare(a):v.direction==="asc"?a-r:r-a}):t})().length/Se);const R=t=>Object.values(Me).flat().includes(t),De=(t,s)=>{if(R(t)&&R(s))return 0;if(R(t)||R(s))return .1;const n=C(t),a=C(s);if(n===a){const o=`${n}-${a}`;return q[o]||.75}const r=`${n}-${a}`,i=`${a}-${n}`;return q[r]||q[i]||q.default},fe=()=>{var x;let t=1;if(d.race.length>0){const c=d.race.reduce((h,g)=>h+(oe.Race[g]||0),0);t*=c}if(d.generation.length>0){const c=d.generation.reduce((h,g)=>h+(oe.Generation[g]||0),0);t*=c}if(d.income.length>0){const c=d.income.reduce((h,g)=>h+(oe.Income[g]||0),0);t*=c}const s=y.map(c=>{const h=j.find(f=>f.Personas===c);if(!h)return null;const g=S(),H=u.states.length>0?u.states:g;let A=0;H.forEach(f=>{const b=h[f],E=typeof b=="string"?parseInt(b.replace(/,/g,"")):b||0;A+=E});const p=Math.round(A*t);return{name:c,audience:p,originalAudience:A,category:C(c),isDemographic:R(c)}}).filter(Boolean);let n=0,a=0;for(let c=0;c<s.length;c++)for(let h=c+1;h<s.length;h++){const g=De(s[c].name,s[h].name);n+=g,a++}const r=s.reduce((c,h)=>c+h.audience,0);if(y.length===1)return{overlapFactor:0,estimatedOverlap:0,uniqueCombined:r,segments:s,totalAudience:((x=s[0])==null?void 0:x.originalAudience)||0,demographicMultiplier:t};const i=a>0?n/a:0,o=Math.round(r*i),l=r-o;return{overlapFactor:i,estimatedOverlap:o,uniqueCombined:l,segments:s,totalAudience:r,demographicMultiplier:t}};return e.jsxs(Xe,{children:[e.jsxs("div",{className:"min-h-screen bg-[#0a0a0a]",children:[e.jsx("div",{className:"border-b border-gray-800 bg-[#0f0f0f] px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-cyan-400 font-black mb-2 tracking-wider uppercase",style:{fontFamily:"Inter, sans-serif"},children:"[ ADMIN / AUDIENCE MANAGEMENT ]"}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-white uppercase",style:{fontFamily:"Inter, sans-serif"},children:"Audience Estimation"})]}),e.jsxs("div",{className:"flex items-center space-x-3 w-full sm:w-auto",children:[e.jsxs("a",{href:Le,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-[#2d3748] text-white rounded-md hover:bg-[#3d4758] transition-colors flex items-center text-sm font-medium",children:[e.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),e.jsx("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]}),e.jsx("span",{children:"Edit Source"})]}),e.jsxs("button",{onClick:Ge,disabled:te,className:"px-4 py-2 bg-[#0891b2] text-white font-medium rounded-md hover:bg-[#0e7490] disabled:opacity-50 transition-all flex items-center text-sm",children:[e.jsx("svg",{className:`w-4 h-4 mr-2 ${te?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:te?"Refreshing...":"Refresh Data"})]})]})]})}),e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[ce&&e.jsxs("div",{className:"bg-red-900/20 border border-red-800 text-red-300 px-4 py-3 rounded-lg flex items-start",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsx("span",{children:ce})]}),be?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(t=>e.jsxs("div",{className:"bg-[#0f1419] border border-gray-800 rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-700 rounded w-1/2 mb-3"}),e.jsx("div",{className:"h-8 bg-gray-700 rounded w-3/4"})]},t))}),e.jsxs("div",{className:"bg-[#0f1419] border border-gray-800 rounded-lg p-4 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-700 rounded w-1/4 mb-4"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[1,2].map(t=>e.jsx("div",{className:"h-10 bg-gray-700 rounded"},t))})]})]}):e.jsxs(e.Fragment,{children:[(u.personas.length>0||u.states.length>0||y.length>0)&&e.jsx("div",{className:"border border-cyan-500/30 rounded-lg p-3 mb-6 bg-[#0a0a0a]",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-xs text-gray-400 font-medium",style:{fontFamily:"Inter, sans-serif"},children:"Active Filters:"}),M&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-300 border border-purple-500/30",children:['Search: "',M,'"']}),y.length>0&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-300 border border-purple-500/30",children:[y.length," Personas"]}),u.states.length>0&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-cyan-500/20 text-cyan-300 border border-cyan-500/30",children:[u.states.length," States"]})]}),e.jsx("button",{onClick:()=>{G({personas:[],states:[]}),V("")},className:"text-xs text-gray-400 hover:text-white transition-colors font-medium",children:"Clear All"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-[#0f1419] border border-gray-800 rounded-lg p-4 relative",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-2 font-semibold uppercase tracking-wider",style:{fontFamily:"Inter, sans-serif"},children:"SEARCH BY PERSONA"}),e.jsxs("button",{onClick:()=>{L==="personas"?(T(null),V("")):(T("personas"),V(""))},className:"w-full px-3 py-2.5 bg-[#0a0a0a] border border-gray-700 rounded text-sm text-white text-left focus:outline-none focus:border-cyan-500 transition-colors flex items-center justify-between",children:[e.jsx("span",{children:u.personas.length>0?`${u.personas.length} personas selected`:"Select Persona..."}),e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),L==="personas"&&e.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-[#0a0a0a] border border-gray-700 rounded shadow-lg max-h-96 overflow-hidden",children:[e.jsx("div",{className:"sticky top-0 bg-[#0a0a0a] border-b border-gray-700 p-2",children:e.jsx("input",{type:"text",placeholder:"Search Persona...",value:M,onChange:t=>V(t.target.value),className:"w-full px-3 py-1.5 bg-[#161b22] border border-gray-600 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-cyan-500",autoFocus:!0})}),e.jsx("div",{className:"bg-cyan-500/10 border-b border-cyan-500/20 px-3 py-2",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-cyan-400 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("p",{className:"text-xs text-cyan-300",children:[e.jsx("span",{className:"font-semibold",children:"Auto-complete:"})," Selecting a persona automatically includes related personas in the same category"]})]})}),e.jsxs("div",{className:"sticky top-[52px] bg-[#0a0a0a] border-b border-gray-700 p-2 flex justify-between",children:[e.jsx("button",{onClick:()=>{const t=ie().filter(s=>s.toLowerCase().includes(M.toLowerCase()));ge("personas",t)},className:"text-xs text-cyan-400 hover:text-cyan-300 font-medium",children:"Select All"}),e.jsx("button",{onClick:()=>G(t=>({...t,personas:[]})),className:"text-xs text-red-400 hover:text-red-300 font-medium",children:"Clear"})]}),e.jsxs("div",{className:"p-2 max-h-60 overflow-y-auto",children:[ie().filter(t=>t.toLowerCase().includes(M.toLowerCase())).map(t=>{const s=C(t);return e.jsxs("label",{className:"flex items-center space-x-2 py-1.5 px-2 hover:bg-gray-800 rounded cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:u.personas.includes(t),onChange:()=>he("personas",t),className:"w-4 h-4 text-cyan-500 border-gray-600 rounded focus:ring-cyan-500"}),e.jsxs("div",{className:"flex-1 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-white",children:t}),s&&e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border ${Te(s)} transition-opacity opacity-60 group-hover:opacity-100`,children:s})]})]},t)}),ie().filter(t=>t.toLowerCase().includes(M.toLowerCase())).length===0&&e.jsx("div",{className:"text-sm text-gray-500 text-center py-2",children:"No personas found"})]})]})]}),e.jsxs("div",{className:"bg-[#0f1419] border border-gray-800 rounded-lg p-4 relative",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-2 font-semibold uppercase tracking-wider",style:{fontFamily:"Inter, sans-serif"},children:"FILTER BY STATES (MULTI-SELECT)"}),e.jsxs("button",{onClick:()=>{T(L==="states"?null:"states")},className:"w-full px-3 py-2.5 bg-[#0a0a0a] border border-gray-700 rounded text-sm text-white text-left focus:outline-none focus:border-cyan-500 transition-colors flex items-center justify-between",children:[e.jsx("span",{children:u.states.length>0?`${u.states.length} states selected`:"Select states..."}),e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),L==="states"&&e.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-[#0a0a0a] border border-gray-700 rounded shadow-lg",children:[e.jsx("div",{className:"sticky top-0 bg-[#0a0a0a] border-b border-gray-700 p-2",children:e.jsx("input",{type:"text",placeholder:"Search states...",value:z,onChange:t=>we(t.target.value),className:"w-full px-3 py-1.5 bg-[#161b22] border border-gray-600 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-cyan-500",autoFocus:!0})}),e.jsxs("div",{className:"sticky top-[52px] bg-[#0a0a0a] border-b border-gray-700 p-2 flex justify-between",children:[e.jsx("button",{onClick:()=>{const t=S().filter(s=>s.toLowerCase().includes(z.toLowerCase()));ge("states",t)},className:"text-xs text-cyan-400 hover:text-cyan-300 font-medium",children:"Select All"}),e.jsx("button",{onClick:()=>G(t=>({...t,states:[]})),className:"text-xs text-red-400 hover:text-red-300 font-medium",children:"Clear"})]}),e.jsxs("div",{className:"p-2 max-h-60 overflow-y-auto",children:[S().filter(t=>t.toLowerCase().includes(z.toLowerCase())).map(t=>e.jsxs("label",{className:"flex items-center space-x-2 py-1.5 px-2 hover:bg-gray-800 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.states.includes(t),onChange:()=>he("states",t),className:"w-4 h-4 text-cyan-500 border-gray-600 rounded focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-white",children:t})]},t)),S().filter(t=>t.toLowerCase().includes(z.toLowerCase())).length===0&&e.jsx("div",{className:"text-sm text-gray-500 text-center py-2",children:"No states found"})]})]})]}),e.jsxs("div",{className:"bg-[#0f1419] border border-gray-800 rounded-lg p-4",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-2 font-semibold uppercase tracking-wider",style:{fontFamily:"Inter, sans-serif"},children:"SORT BY"}),e.jsxs("select",{value:`${v.key}-${v.direction}`,onChange:t=>{const[s,n]=t.target.value.split("-");Ne({key:s,direction:n})},className:"w-full px-3 py-2.5 bg-[#0a0a0a] border border-gray-700 rounded text-sm text-white focus:outline-none focus:border-cyan-500 transition-colors",style:{fontFamily:"Inter, sans-serif"},children:[e.jsx("option",{value:"audience-desc",children:"Audience: High to Low"}),e.jsx("option",{value:"audience-asc",children:"Audience: Low to High"}),e.jsx("option",{value:"Personas-asc",children:"Alphabet: A-Z"}),e.jsx("option",{value:"Personas-desc",children:"Alphabet: Z-A"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-[#0f1419] border border-gray-800 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4",style:{fontFamily:"Inter, sans-serif"},children:["Audience Segments (",j.length,")"]}),u.personas.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-cyan-500/20 text-cyan-300 border border-cyan-500/30",children:["Category: ",C(u.personas[0])||"Mixed"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Showing all related segments"})]}),e.jsxs("div",{className:"space-y-2",children:[Be.map(t=>{const s=Ae.includes(t.Personas),n=y.includes(t.Personas),a=C(t.Personas),r=S(),o=(u.states.length>0?u.states:r).reduce((l,x)=>{const c=t[x],h=typeof c=="string"?parseInt(c.replace(/,/g,"")):parseFloat(c)||0;return l+h},0);return e.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"w-full px-4 py-3 bg-[#0a0a0a] hover:bg-gray-800 transition-colors flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:l=>{l.stopPropagation(),B(x=>x.includes(t.Personas)?x.filter(c=>c!==t.Personas):[...x,t.Personas])},className:"w-4 h-4 text-cyan-500 border-gray-600 rounded focus:ring-cyan-500"}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("div",{className:`text-sm font-medium ${pe(a)}`,children:t.Personas}),e.jsxs("div",{className:"text-xs font-bold text-white mt-1",children:["Audience Size: ",N(o)]}),ue[t.Personas]&&e.jsx("p",{className:"text-xs text-gray-500 mt-1 leading-relaxed",children:ue[t.Personas]})]})]}),e.jsx("button",{onClick:()=>{Ce(l=>l.includes(t.Personas)?l.filter(x=>x!==t.Personas):[...l,t.Personas])},className:"p-1 hover:bg-gray-700 rounded transition-colors",children:e.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${s?"transform rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),s&&e.jsx("div",{className:"bg-[#161b22] border-t border-gray-700",children:e.jsx("div",{className:"p-3 space-y-2",children:r.map(l=>{const x=t[l];return e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 hover:bg-gray-800 rounded",children:[e.jsx("span",{className:"text-sm text-gray-300",children:l}),e.jsx("span",{className:"text-sm font-medium text-cyan-400",children:N(x)})]},l)})})})]},t.id)}),j.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx("p",{className:"text-sm",children:"No audience segments found"}),e.jsx("p",{className:"text-xs mt-1",children:"Try adjusting your filters"})]})]})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-[#0f1419] border border-gray-800 rounded-lg p-4",children:[e.jsx("h3",{className:"text-base font-bold text-white mb-3",style:{fontFamily:"Inter, sans-serif"},children:"State Distribution"}),(()=>{const t=S(),s=u.states.length>0?u.states:t,n={};let a=0;(y.length>0?y:j.map(p=>p.Personas)).forEach(p=>{const f=j.find(b=>b.Personas===p);f&&s.forEach(b=>{const E=f[b],F=typeof E=="string"?parseInt(E.replace(/,/g,"")):E||0;n[b]=(n[b]||0)+F,a+=F})});const i=Object.entries(n).sort((p,f)=>f[1]-p[1]),o=u.states.length>0&&u.states.length<=5?i:i.slice(0,5),l=o.reduce((p,[,f])=>p+f,0),x=a-l,c=["#06b6d4","#3b82f6","#8b5cf6","#ec4899","#f59e0b","#6b7280"],h=[...o.map(([p,f],b)=>({state:p,value:f,percentage:(f/a*100).toFixed(1),color:c[b]})),...x>0?[{state:"Others",value:x,percentage:(x/a*100).toFixed(1),color:c[5]}]:[]],g=91,H=36;let A=-90;return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs text-gray-400",children:y.length>0?`Selected ${y.length} persona(s)`:`All ${j.length} personas`}),e.jsxs("div",{className:"flex justify-center mb-3 relative",children:[e.jsxs("svg",{width:"240",height:"240",viewBox:"0 0 240 240",children:[e.jsx("g",{className:"transform -rotate-90",style:{transformOrigin:"120px 120px"},children:h.map((p,f)=>{const b=p.value/a*360,E=A,F=A+b;if(b>=359.9){const qe=g-H;return A=F,e.jsxs("g",{onMouseEnter:()=>Y(p),onMouseLeave:()=>Y(null),style:{cursor:"pointer"},children:[e.jsx("circle",{cx:"120",cy:"120",r:g,fill:"none",stroke:p.color,strokeWidth:H,className:"hover:opacity-80 transition-opacity"}),e.jsx("circle",{cx:"120",cy:"120",r:qe,fill:"#0f1419"})]},f)}const Q=E*Math.PI/180,J=F*Math.PI/180,P=g-H,Oe=120+g*Math.cos(Q),Re=120+g*Math.sin(Q),He=120+g*Math.cos(J),Ve=120+g*Math.sin(J),ze=120+P*Math.cos(J),We=120+P*Math.sin(J),Ye=120+P*Math.cos(Q),Ze=120+P*Math.sin(Q),ye=b>180?1:0,_e=`
                                  M ${Oe} ${Re}
                                  A ${g} ${g} 0 ${ye} 1 ${He} ${Ve}
                                  L ${ze} ${We}
                                  A ${P} ${P} 0 ${ye} 0 ${Ye} ${Ze}
                                  Z
                                `;return A=F,e.jsx("path",{d:_e,fill:p.color,className:"hover:opacity-80 transition-opacity cursor-pointer",onMouseEnter:()=>Y(p),onMouseLeave:()=>Y(null)},f)})}),e.jsxs("g",{children:[e.jsx("text",{x:"120",y:"108",textAnchor:"middle",dominantBaseline:"middle",className:"text-xs fill-gray-400",style:{pointerEvents:"none"},children:"Total Audience"}),e.jsx("text",{x:"120",y:"132",textAnchor:"middle",dominantBaseline:"middle",className:"text-2xl font-bold fill-cyan-400",style:{pointerEvents:"none"},children:N(a)})]})]}),W&&e.jsxs("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-3 py-2 rounded shadow-lg text-xs whitespace-nowrap z-10 pointer-events-none",children:[e.jsx("div",{className:"font-semibold",children:W.state}),e.jsxs("div",{className:"text-gray-300",children:[W.percentage,"% (",N(W.value),")"]})]})]}),e.jsx("div",{className:"space-y-2 text-xs",children:h.map((p,f)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:p.color}}),e.jsx("span",{className:"text-gray-300",children:p.state})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-gray-400",children:[p.percentage,"%"]}),e.jsx("span",{className:"text-cyan-400 font-medium",children:N(p.value)})]})]},f))}),y.length>=1&&e.jsxs("button",{onClick:()=>$(!0),className:"w-full mt-4 px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white text-xs font-medium rounded transition-colors flex items-center justify-center gap-1.5",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Personal Affinity Overlap"]}),e.jsx("button",{onClick:()=>B([]),className:"w-full mt-4 px-3 py-2 bg-red-600 hover:bg-red-700 text-white text-xs font-medium rounded transition-colors",children:"Clear All"})]})})()]}),ae.length>0&&e.jsx("div",{className:"space-y-4",children:ae.map((t,s)=>{const a=(i=>{const o=[];return i.race.length>0&&o.push(...i.race),i.generation.length>0&&o.push(...i.generation.map(l=>l.includes("Generation Z")?"Gen Z":l.includes("Millennials")?"Millennials":l.includes("Generation X")?"Gen X":l.includes("Baby Boomers")?"Boomers":l)),i.income.length>0&&o.push(...i.income.map(l=>l.includes("B40")?"B40":l.includes("M40")?"M40":l.includes("T20")?"T20":l)),o})(t.demographics),r=Ue.createRef();return e.jsx("div",{className:"bg-[#0f1419] border border-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center flex-1",children:e.jsx("input",{ref:r,type:"text",value:t.name,onChange:i=>{D(o=>o.map(l=>l.id===t.id?{...l,name:i.target.value}:l))},onBlur:async i=>{try{await me(t.id,{name:i.target.value}),console.log("Group name updated")}catch(o){console.error("Error updating group name:",o)}},className:"text-base font-bold text-white bg-transparent border-none outline-none focus:outline-none hover:bg-gray-800/30 px-2 py-1 rounded transition-colors",style:{fontFamily:"Inter, sans-serif",width:`${Math.max(150,(t.name.length||15)*10)}px`},placeholder:"Group Name"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{B([...t.personas]),k({race:[...t.demographics.race],generation:[...t.demographics.generation],income:[...t.demographics.income]}),re(t.id),$(!0)},className:"text-xs text-gray-400 hover:text-purple-400 transition-colors",title:"Edit audience selections",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:async()=>{if(confirm(`Delete "${t.name}"?`))try{await Ie(t.id),D(i=>i.filter(o=>o.id!==t.id))}catch(i){console.error("Error deleting group:",i),alert("Failed to delete group. Please try again.")}},className:"text-xs text-gray-400 hover:text-red-400 transition-colors",title:"Delete group",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400 font-medium",children:"Audience Segments:"}),t.personas.map((i,o)=>{const l=C(i);return e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${pe(l)} bg-gray-800/50 border border-gray-700`,children:i},o)})]}),a.length>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400 font-medium",children:"Demographics:"}),a.map((i,o)=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium text-cyan-400 bg-cyan-900/20 border border-cyan-700/30",children:i},o))]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm pt-2 border-t border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"Total Audience:"}),e.jsx("span",{className:"font-bold text-white",children:N(t.totalAudience)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"Unduplicated:"}),e.jsx("span",{className:"font-bold text-purple-400",children:N(t.unduplicated)})]})]})]})},t.id)})})]})]})]})]})]}),Ee&&(()=>{const t=fe();return t.overlapFactor,e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#0a0a0a] rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 flex items-center justify-between border-b border-gray-800",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:y.length>=2?"Persona Affinity & Overlap Estimation":"Audience Group Builder"}),e.jsx("button",{onClick:()=>{$(!1),re(null),B([]),k({race:[],generation:[],income:[]})},className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-[#0f1419] border border-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wider",children:"Demographic Filters"}),(d.race.length>0||d.generation.length>0||d.income.length>0)&&e.jsx("button",{onClick:()=>k({race:[],generation:[],income:[]}),className:"text-xs text-cyan-400 hover:text-cyan-300 transition-colors",children:"Clear All"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative demographic-filter-dropdown",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-2 font-semibold uppercase tracking-wider",children:"Race"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>Z(w==="race"?null:"race"),className:"w-full px-3 py-2 bg-[#0a0a0a] border border-gray-700 rounded text-sm text-left text-white focus:outline-none focus:border-cyan-500 transition-colors flex items-center justify-between",children:[e.jsx("span",{className:"truncate",children:d.race.length===0?"Select Race...":`${d.race.length} selected`}),e.jsx("svg",{className:`w-4 h-4 transition-transform ${w==="race"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),w==="race"&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-[#0a0a0a] border border-gray-700 rounded shadow-lg max-h-48 overflow-y-auto",children:["Malay","Chinese","Indian"].map(s=>e.jsxs("label",{className:"flex items-center px-3 py-2 hover:bg-gray-800 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.race.includes(s),onChange:n=>{const a=n.target.checked?[...d.race,s]:d.race.filter(r=>r!==s);k(r=>({...r,race:a}))},className:"w-4 h-4 text-cyan-500 border-gray-600 rounded focus:ring-cyan-500 mr-2"}),e.jsx("span",{className:"text-sm text-white",children:s})]},s))})]}),d.race.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:d.race.map(s=>e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-cyan-500/20 text-cyan-300 border border-cyan-500/30",children:[s,e.jsx("button",{onClick:()=>k(n=>({...n,race:n.race.filter(a=>a!==s)})),className:"ml-1 hover:text-cyan-100",children:"×"})]},s))})]}),e.jsxs("div",{className:"relative demographic-filter-dropdown",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-2 font-semibold uppercase tracking-wider",children:"Generation / Category"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>Z(w==="generation"?null:"generation"),className:"w-full px-3 py-2 bg-[#0a0a0a] border border-gray-700 rounded text-sm text-left text-white focus:outline-none focus:border-cyan-500 transition-colors flex items-center justify-between",children:[e.jsx("span",{className:"truncate",children:d.generation.length===0?"Select Generation...":`${d.generation.length} selected`}),e.jsx("svg",{className:`w-4 h-4 transition-transform ${w==="generation"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),w==="generation"&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-[#0a0a0a] border border-gray-700 rounded shadow-lg max-h-48 overflow-y-auto",children:["Generation Z (Gen Z)","Millennials (Gen Y)","Generation X (Gen X)","Baby Boomers"].map(s=>e.jsxs("label",{className:"flex items-center px-3 py-2 hover:bg-gray-800 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.generation.includes(s),onChange:n=>{const a=n.target.checked?[...d.generation,s]:d.generation.filter(r=>r!==s);k(r=>({...r,generation:a}))},className:"w-4 h-4 text-cyan-500 border-gray-600 rounded focus:ring-cyan-500 mr-2"}),e.jsx("span",{className:"text-sm text-white",children:s})]},s))})]}),d.generation.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:d.generation.map(s=>e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-cyan-500/20 text-cyan-300 border border-cyan-500/30",children:[s,e.jsx("button",{onClick:()=>k(n=>({...n,generation:n.generation.filter(a=>a!==s)})),className:"ml-1 hover:text-cyan-100",children:"×"})]},s))})]}),e.jsxs("div",{className:"relative demographic-filter-dropdown",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-2 font-semibold uppercase tracking-wider",children:"Income Group"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>Z(w==="income"?null:"income"),className:"w-full px-3 py-2 bg-[#0a0a0a] border border-gray-700 rounded text-sm text-left text-white focus:outline-none focus:border-cyan-500 transition-colors flex items-center justify-between",children:[e.jsx("span",{className:"truncate",children:d.income.length===0?"Select Income...":`${d.income.length} selected`}),e.jsx("svg",{className:`w-4 h-4 transition-transform ${w==="income"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),w==="income"&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-[#0a0a0a] border border-gray-700 rounded shadow-lg max-h-48 overflow-y-auto",children:["B40 (Bottom 40%)","M40 (Middle 40%)","T20 (Top 20%)"].map(s=>e.jsxs("label",{className:"flex items-center px-3 py-2 hover:bg-gray-800 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.income.includes(s),onChange:n=>{const a=n.target.checked?[...d.income,s]:d.income.filter(r=>r!==s);k(r=>({...r,income:a}))},className:"w-4 h-4 text-cyan-500 border-gray-600 rounded focus:ring-cyan-500 mr-2"}),e.jsx("span",{className:"text-sm text-white",children:s})]},s))})]}),d.income.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:d.income.map(s=>e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-cyan-500/20 text-cyan-300 border border-cyan-500/30",children:[s,e.jsx("button",{onClick:()=>k(n=>({...n,income:n.income.filter(a=>a!==s)})),className:"ml-1 hover:text-cyan-100",children:"×"})]},s))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-teal-900/40 border border-teal-700/50 rounded-lg p-6",children:[e.jsx("div",{className:"text-xs text-teal-200 mb-2 uppercase tracking-wide",children:"Total Audience"}),e.jsx("div",{className:"text-4xl font-bold text-white mb-1",children:N(t.totalAudience)}),e.jsx("div",{className:"text-xs text-teal-300",children:t.demographicMultiplier<1?`Filtered by demographics (${(t.demographicMultiplier*100).toFixed(1)}%)`:"Sum of all selected segments"})]}),e.jsxs("div",{className:"bg-purple-900/40 border border-purple-700/50 rounded-lg p-6",children:[e.jsx("div",{className:"text-xs text-purple-200 mb-2 uppercase tracking-wide",children:"Estimated Unduplicated"}),e.jsx("div",{className:"text-4xl font-bold text-purple-300",children:N(t.uniqueCombined)}),e.jsxs("div",{className:"text-xs text-purple-300",children:["After ",(t.overlapFactor*100).toFixed(0),"% overlap adjustment"]})]})]}),y.length>=2&&e.jsxs("div",{className:"bg-[#0f1419] rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-6",children:"Overlap Breakdown"}),e.jsxs("div",{className:"space-y-4",children:[t.demographicMultiplier<1&&e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-800",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Demographic Filter Applied"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-400",children:[(t.demographicMultiplier*100).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-800",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Overlap Factor Applied"}),e.jsxs("span",{className:"text-2xl font-bold text-cyan-400",children:[(t.overlapFactor*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Estimated Overlap"}),e.jsxs("span",{className:"text-2xl font-bold text-orange-400",children:["-",N(t.estimatedOverlap)]})]})]})]}),e.jsxs("div",{className:"bg-[#0f1419] rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-6",children:["Selected Segments (",t.segments.length,")"]}),e.jsx("div",{className:"space-y-3",children:t.segments.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-600 flex items-center justify-center text-white text-sm font-bold",children:n+1}),e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-medium text-white mb-1",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-800 text-gray-300",children:["Cluster: ",s.category]}),s.isDemographic&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-green-900/40 text-green-300 border border-green-700/50",children:"race"})]})]})]}),e.jsx("div",{className:"text-lg font-medium text-white",children:N(s.audience)})]},n))})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>$(!1),className:"px-6 py-2.5 bg-gray-700 hover:bg-gray-600 text-white text-sm font-medium rounded transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:async()=>{try{const s=fe();if(O){const n={personas:[...y],demographics:{race:[...d.race],generation:[...d.generation],income:[...d.income]},totalAudience:s.totalAudience,unduplicated:s.uniqueCombined,overlapFactor:s.overlapFactor},a=await me(O,n);D(r=>r.map(i=>i.id===O?a:i)),re(null)}else{const a={name:`Audience Group #${ae.length+1}`,personas:[...y],demographics:{race:[...d.race],generation:[...d.generation],income:[...d.income]},totalAudience:s.totalAudience,unduplicated:s.uniqueCombined,overlapFactor:s.overlapFactor},r=await Pe(a);D(i=>[...i,r])}B([]),k({race:[],generation:[],income:[]}),$(!1)}catch(s){console.error("Error saving audience group:",s),alert("Failed to save audience group. Please try again.")}},className:"px-6 py-2.5 bg-cyan-600 hover:bg-cyan-700 text-white text-sm font-medium rounded transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:O?"M5 13l4 4L19 7":"M12 4v16m8-8H4"})}),O?"Save":"Add to Plan"]})]})]})]})})})()]})}export{ot as default};
