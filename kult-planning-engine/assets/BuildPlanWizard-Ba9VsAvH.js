import{j as e}from"./index-C1JaId44.js";import{r as d,e as gt,f as pt,c as ft}from"./vendor-7lAwbL4C.js";import{L as bt}from"./Layout-BIIFe71_.js";import{a as U}from"./utils-B9ygI19o.js";const vt=({recommendation:R,onAdd:E,isAdded:L=!1})=>{const{id:c,name:z,type:I,confidence:G,reach:t,cost:T,reason:C,stats:g={},weight:M}=R,$=_=>_>=80?"bg-green-500":_>=60?"bg-yellow-500":"bg-orange-500",W=_=>_?_>=1e6?`${(_/1e6).toFixed(2)}M`:_>=1e3?`${(_/1e3).toFixed(1)}k`:_.toLocaleString():"N/A";return e.jsxs("div",{className:`mb-3 p-4 rounded-lg border-2 transition-all ${L?"bg-indigo-900/20 border-indigo-500":"bg-[#0f0f0f] border-gray-800 hover:border-cyan-500"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h4",{className:"text-white font-semibold text-sm",children:z}),G&&e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full text-white ${$(G)}`,children:[G,"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3 text-xs",children:[t&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Reach:"}),e.jsx("span",{className:"text-white ml-1 font-semibold",children:W(t)})]}),I==="budget"&&T&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Budget:"}),e.jsxs("span",{className:"text-white ml-1 font-semibold",children:["RM ",W(T)]})]}),I!=="budget"&&I!=="audience"&&T&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"CPM:"}),e.jsxs("span",{className:"text-white ml-1 font-semibold",children:["RM ",T]})]}),M&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Weight:"}),e.jsxs("span",{className:"text-white ml-1 font-semibold",children:[M,"%"]})]}),g.impressions&&I!=="audience"&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Impressions:"}),e.jsx("span",{className:"text-white ml-1 font-semibold",children:W(g.impressions)})]})]}),C&&e.jsxs("div",{className:"mb-3 p-2 bg-cyan-900/20 border-l-2 border-cyan-500 rounded text-xs text-gray-300",children:[e.jsx("strong",{className:"text-cyan-400",children:"Why:"})," ",C]}),e.jsx("button",{onClick:()=>E(R),className:`w-full py-2 px-4 rounded-lg font-semibold text-sm transition-all ${L?"bg-red-600 text-white hover:bg-red-700":"bg-gradient-to-r from-cyan-500 to-purple-600 text-white hover:from-cyan-600 hover:to-purple-700"}`,children:L?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Remove from Plan"]}):e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add to Plan"]})})]})},Ns=({currentStep:R,recommendations:E=[],onAddRecommendation:L,selectedItems:c=[],isLoading:z=!1})=>{const[I,G]=d.useState(!1),t={audience:{title:"AI Recommended Audiences",icon:e.jsx("svg",{className:"w-6 h-6 text-cyan-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),subtitle:"Top audiences for your campaign"},geography:{title:"AI Recommended Geo Mix",icon:e.jsx("svg",{className:"w-6 h-6 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),subtitle:"Optimal geography weighting"},formats:{title:"AI Recommended Formats",icon:e.jsx("svg",{className:"w-6 h-6 text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),subtitle:"Best ad formats for your objective"},sites:{title:"AI Recommended Sites",icon:e.jsx("svg",{className:"w-6 h-6 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})}),subtitle:"Top publishers for your campaign"},budget:{title:"AI Recommended Budget Split",icon:e.jsx("svg",{className:"w-6 h-6 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),subtitle:"Optimal budget allocation"},overview:{title:"AI Brief Analysis",icon:e.jsx("svg",{className:"w-6 h-6 text-cyan-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),subtitle:"Campaign strategy recommendations"}},T=t[R]||t.overview,C=g=>c.some(M=>typeof M=="string"?M===g:M.id?M.id===g:!1);return e.jsxs("div",{className:"h-full flex flex-col bg-[#0a0a0a] border-l border-gray-800",children:[e.jsxs("div",{className:"p-4 border-b border-gray-800 bg-[#0f0f0f]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[T.icon,e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-sm",children:T.title}),e.jsx("p",{className:"text-gray-400 text-xs",children:T.subtitle})]})]}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-cyan-900/20 border border-cyan-500/30 rounded-full",children:[e.jsx("svg",{className:"w-3 h-3 text-cyan-400",fill:"currentColor",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M8 2L9.5 6.5L14 8L9.5 9.5L8 14L6.5 9.5L2 8L6.5 6.5L8 2Z"})}),e.jsx("span",{className:"text-cyan-400 text-xs font-semibold",children:"Powered by AI"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[z&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx("div",{className:"w-10 h-10 border-4 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Analyzing your campaign brief..."})]}),!z&&E.length>0&&e.jsx("div",{className:"space-y-4",children:R==="overview"?E.map(g=>g.subtype==="health"?e.jsxs("div",{className:"bg-[#0f0f0f] border border-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-white font-bold text-sm",children:g.name}),e.jsxs("div",{className:`text-2xl font-bold ${g.score>=80?"text-green-400":g.score>=60?"text-yellow-400":"text-orange-400"}`,children:[g.score,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-800 rounded-full h-3 mb-2",children:e.jsx("div",{className:`h-3 rounded-full ${g.score>=80?"bg-green-500":g.score>=60?"bg-yellow-500":"bg-orange-500"}`,style:{width:`${g.score}%`}})}),e.jsx("p",{className:"text-gray-400 text-xs",children:g.reason})]},g.id):g.subtype==="strengths"?e.jsxs("div",{className:"bg-[#0f0f0f] border border-green-800/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h4",{className:"text-white font-bold text-sm",children:g.name})]}),e.jsx("div",{className:"space-y-2",children:g.items.map((M,$)=>e.jsxs("div",{className:"bg-green-900/10 border border-green-800/30 rounded-lg p-3",children:[e.jsx("div",{className:"text-green-300 text-sm font-semibold mb-1",children:M.title}),e.jsx("div",{className:"text-gray-400 text-xs",children:M.description})]},$))})]},g.id):g.subtype==="risks"?e.jsxs("div",{className:"bg-[#0f0f0f] border border-orange-800/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("svg",{className:"w-5 h-5 text-orange-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("h4",{className:"text-white font-bold text-sm",children:g.name})]}),e.jsx("div",{className:"space-y-2",children:g.items.map((M,$)=>e.jsxs("div",{className:`border rounded-lg p-3 ${M.level==="high"?"bg-red-900/10 border-red-800/30":"bg-orange-900/10 border-orange-800/30"}`,children:[e.jsx("div",{className:`text-sm font-semibold mb-1 ${M.level==="high"?"text-red-300":"text-orange-300"}`,children:M.title}),e.jsx("div",{className:"text-gray-400 text-xs mb-2",children:M.description}),e.jsxs("div",{className:"text-cyan-400 text-xs font-medium",children:["â†’ ",M.action]})]},$))})]},g.id):g.subtype==="optimizations"?e.jsxs("div",{className:"bg-[#0f0f0f] border border-purple-800/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("h4",{className:"text-white font-bold text-sm",children:g.name})]}),e.jsx("div",{className:"space-y-2",children:g.items.map((M,$)=>e.jsxs("div",{className:"bg-purple-900/10 border border-purple-800/30 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("div",{className:"text-purple-300 text-sm font-semibold",children:M.title}),e.jsx("div",{className:"flex gap-1",children:e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded ${M.impact==="high"?"bg-green-900/30 text-green-400":"bg-yellow-900/30 text-yellow-400"}`,children:[M.impact," impact"]})})]}),e.jsx("div",{className:"text-gray-400 text-xs",children:M.description})]},$))})]},g.id):g.subtype==="metrics"?e.jsxs("div",{className:"bg-[#0f0f0f] border border-cyan-800/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("svg",{className:"w-5 h-5 text-cyan-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("h4",{className:"text-white font-bold text-sm",children:g.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-cyan-900/10 border border-cyan-800/30 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-1 text-cyan-400 text-xs mb-1",children:[e.jsx("span",{children:"Reach"}),e.jsx("button",{onClick:()=>G(!I),className:"w-3 h-3 text-cyan-400/60 hover:text-cyan-400 cursor-pointer transition-colors focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 focus:ring-offset-[#0f0f0f] rounded-full","aria-label":"Toggle reach explanation","aria-expanded":I,children:e.jsx("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),e.jsxs("div",{className:"text-white text-lg font-bold",children:[(g.metrics.reach/1e6).toFixed(1),"M"]})]}),e.jsxs("div",{className:"bg-cyan-900/10 border border-cyan-800/30 rounded-lg p-3",children:[e.jsx("div",{className:"text-cyan-400 text-xs mb-1",children:"Impressions"}),e.jsxs("div",{className:"text-white text-lg font-bold",children:[(g.metrics.impressions/1e6).toFixed(1),"M"]})]}),e.jsxs("div",{className:"bg-cyan-900/10 border border-cyan-800/30 rounded-lg p-3",children:[e.jsx("div",{className:"text-cyan-400 text-xs mb-1",children:"Estimated CTR"}),e.jsx("div",{className:"text-white text-lg font-bold",children:g.metrics.ctr})]}),e.jsxs("div",{className:"bg-cyan-900/10 border border-cyan-800/30 rounded-lg p-3",children:[e.jsx("div",{className:"text-cyan-400 text-xs mb-1",children:"Est. Clicks"}),e.jsxs("div",{className:"text-white text-lg font-bold",children:[(g.metrics.clicks/1e3).toFixed(0),"K"]})]})]}),I&&e.jsxs("div",{className:"mt-3 bg-cyan-900/10 border border-cyan-500/30 rounded-lg p-3 animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-cyan-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h5",{className:"text-cyan-400 font-semibold text-xs",children:"About Estimated Reach"})]}),e.jsx("button",{onClick:()=>G(!1),className:"text-gray-500 hover:text-gray-300 transition-colors","aria-label":"Close explanation",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("ul",{className:"space-y-1.5 text-xs text-gray-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400 mt-0.5",children:"â€¢"}),e.jsx("span",{children:"Modeled using campaign duration and frequency benchmarks"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400 mt-0.5",children:"â€¢"}),e.jsx("span",{children:"Adjusted for target audience size and demographics"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400 mt-0.5",children:"â€¢"}),e.jsx("span",{children:"Accounts for geographic penetration and market coverage"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400 mt-0.5",children:"â€¢"}),e.jsx("span",{className:"text-gray-400 italic",children:"Actual delivery may vary based on campaign execution"})]})]})]}),e.jsx("p",{className:"text-gray-500 text-xs mt-3",children:g.reason})]},g.id):null):E.map(g=>e.jsx(vt,{recommendation:g,onAdd:L,isAdded:C(g.type==="audience"?g.name:g.id)},g.id))}),!z&&E.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Complete your campaign brief to see AI recommendations"})]})]})]})},yt=({planData:R={},onGeneratePlan:E,isComplete:L=!1})=>{const[c,z]=d.useState(!0),{audiences:I=[],geographies:G=[],formats:t=[],sites:T=[],totalBudget:C=0}=R,g=W=>W?`RM ${W.toLocaleString()}`:"RM 0",$=(()=>{let W=0;const _=5;return I.length>0&&W++,G.length>0&&W++,t.length>0&&W++,T.length>0&&W++,C>0&&W++,Math.round(W/_*100)})();return e.jsx("div",{className:"fixed left-0 right-0 bg-[#0f0f0f]/98 backdrop-blur-lg border-t-2 border-indigo-500 shadow-2xl z-40 transition-all duration-300 bottom-0",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-2.5",children:c?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>z(!1),className:"text-gray-400 hover:text-white transition-colors",title:"Expand plan summary",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),e.jsx("span",{className:"text-white text-sm font-semibold",children:"My Campaign Plan"}),e.jsxs("span",{className:"text-cyan-400 text-xs font-semibold",children:[$,"%"]}),e.jsx("div",{className:"w-24 h-1.5 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-purple-600",style:{width:`${$}%`}})})]}),e.jsx("button",{onClick:E,disabled:!L,className:`px-6 py-2 rounded-lg font-semibold text-sm transition-all ${L?"bg-gradient-to-r from-cyan-500 to-purple-600 text-white hover:from-cyan-600 hover:to-purple-700":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:"Generate Plan"})]}):e.jsx("div",{children:e.jsxs("div",{className:"flex items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-white font-bold text-sm",children:"My Campaign Plan"}),e.jsx("button",{onClick:()=>z(!0),className:"text-gray-400 hover:text-white transition-colors",title:"Collapse plan summary",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsxs("span",{className:"text-cyan-400 text-xs font-semibold",children:[$,"% complete"]})]}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-purple-600 transition-all duration-500",style:{width:`${$}%`}})})]}),e.jsxs("div",{className:"flex gap-6 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Audiences:"}),e.jsx("span",{className:"text-white ml-1 font-semibold",children:I.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Geo:"}),e.jsx("span",{className:"text-white ml-1 font-semibold",children:G.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Formats:"}),e.jsx("span",{className:"text-white ml-1 font-semibold",children:t.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Sites:"}),e.jsx("span",{className:"text-white ml-1 font-semibold",children:T.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Budget:"}),e.jsx("span",{className:"text-white ml-1 font-semibold",children:g(C)})]})]}),e.jsx("button",{onClick:E,disabled:!L,className:`px-6 py-3 rounded-lg font-semibold text-sm transition-all whitespace-nowrap ${L?"bg-gradient-to-r from-cyan-500 to-purple-600 text-white hover:from-cyan-600 hover:to-purple-700 shadow-lg hover:shadow-cyan-500/50":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:L?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Generate Media Plan"]}):"Complete selections to generate"})]})})})})},jt={"High Impact":[{id:"masthead",name:"Masthead",description:"Top-of-page premium placement",bestFor:"Product launches, brand awareness",tags:["Awareness"]},{id:"takeover",name:"Site Takeover",description:"Full-site branded experience",bestFor:"Major campaigns, exclusive visibility",tags:["Awareness","Brand building"]},{id:"billboard",name:"Billboard",description:"Large above-the-fold placement",bestFor:"High visibility, storytelling",tags:["Awareness"]}],Video:[{id:"instream",name:"In-Stream Video",description:"Pre-roll, mid-roll, post-roll video ads",bestFor:"Brand storytelling, high engagement",tags:["Awareness","Engagement"]},{id:"outstream",name:"Out-Stream Video",description:"Auto-play video in content feed",bestFor:"Extended reach without video inventory",tags:["Awareness"]},{id:"bumper",name:"Bumper Ad",description:"6-second non-skippable video",bestFor:"Quick brand recall, frequency",tags:["Awareness"]}],"Display & Native":[{id:"banner",name:"Banner (MPU, Leaderboard)",description:"Standard display sizes",bestFor:"Cost-efficient reach",tags:["Awareness","Traffic"]},{id:"native",name:"Native Article",description:"Content-style ad in feed",bestFor:"Editorial context, engagement",tags:["Engagement","Traffic"]},{id:"carousel",name:"Carousel",description:"Multi-image swipeable format",bestFor:"Product showcases, storytelling",tags:["Engagement","Consideration"]}],"Lead & Performance":[{id:"lead_form",name:"Lead Form",description:"Inline data capture form",bestFor:"Test drives, sign-ups, downloads",tags:["Lead generation","Conversions"]},{id:"product_collector",name:"Product Collector",description:"Multi-product showcase with CTA",bestFor:"E-commerce, catalog browsing",tags:["Conversions","Traffic"]},{id:"data_capture",name:"Data Capture",description:"Interactive form with incentives",bestFor:"Email collection, user profiling",tags:["Lead generation"]}],Interactive:[{id:"quiz",name:"Quiz / Poll",description:"Interactive engagement unit",bestFor:"User engagement, data collection",tags:["Engagement"]},{id:"ar_filter",name:"AR Filter / Try-On",description:"Augmented reality experience",bestFor:"Beauty, fashion, experiential",tags:["Engagement","Brand building"]},{id:"game",name:"Gamified Unit",description:"Mini-game or challenge",bestFor:"High engagement, viral potential",tags:["Engagement"]}]},ae={OTT:[{id:"astro_go",name:"Astro GO",icon:"tv",category:"Premium OTT",tags:["News","Entertainment","Sports","Movies"],description:"Premium OTT app with high household penetration and longer session durations",monthlyTraffic:"5.2M"},{id:"stadium_astro",name:"Stadium Astro",icon:"sports",category:"Sports OTT",tags:["Sports","EPL","Football"],description:"Male-skewed sports audience, strong EPL affinity",monthlyTraffic:"2.8M"},{id:"sooka",name:"Sooka",icon:"film",category:"Entertainment OTT",tags:["Movies","Series","Entertainment"],description:"Growing OTT platform with diverse content library",monthlyTraffic:"1.9M"}],Web:[{id:"awani",name:"Astro Awani",icon:"newspaper",category:"News",tags:["News","Current Affairs","Business"],description:"Leading Malaysian news portal, high credibility",monthlyTraffic:"8.5M"},{id:"gempak",name:"Gempak",icon:"sparkles",category:"Entertainment",tags:["Entertainment","Celebrities","Youth"],description:"Youth-focused entertainment portal",monthlyTraffic:"6.2M"},{id:"xuan",name:"Xuan",icon:"globe",category:"Chinese Lifestyle",tags:["Chinese","Lifestyle","Entertainment"],description:"Chinese-language lifestyle and entertainment",monthlyTraffic:"3.1M"},{id:"nona",name:"Nona",icon:"user",category:"Women's Lifestyle",tags:["Fashion","Beauty","Lifestyle","Women"],description:"Women's lifestyle, fashion, and beauty content",monthlyTraffic:"4.5M"}],Social:[{id:"facebook",name:"Facebook",icon:"facebook",category:"Social",tags:["Social","All Demographics","Gen X","Millennials","B40","M40","T20"],description:"Malaysia's largest social network with 22.35M monthly active users (66.5% ad reach)",monthlyTraffic:"22.35M",traffic:"22.35M",formats:["Static Image","Vertical Video","Carousel","Stories"],relevanceScore:100},{id:"instagram",name:"Instagram",icon:"instagram",category:"Social",tags:["Social","Millennials","Gen Z","Visual Content","Lifestyle"],description:"Visual-first platform with 15.70M monthly active users in Malaysia (46.7% ad reach)",monthlyTraffic:"15.70M",traffic:"15.70M",formats:["Static Image","Vertical Video","Stories","Reels"],relevanceScore:95},{id:"tiktok",name:"TikTok",icon:"tiktok",category:"Social",tags:["Social","Gen Z","Entertainment","Short Video"],description:"Fastest-growing platform with 28.68M monthly active users in Malaysia (85.4% ad reach)",monthlyTraffic:"28.68M",traffic:"28.68M",formats:["Vertical Video","In-Feed Ads","Top View"],relevanceScore:90}]},Te={Race:{Malay:.697,Chinese:.228,Indian:.067},Generation:{"Gen Z":.254,Millennials:.303,"Gen X":.245,Boomers:.198},Income:{B40:.4,M40:.4,T20:.2}},wt={Entertainment:["Entertaiment","Comedy Lover","Horror","Romantic Comedy","Action & Adventure","Animation","Sci-Fi & Fantasy","Music & Concert Goers"],Sports:["Sports","EPL Super Fans","Badminton","Golf Fans","Sepak Takraw","Esports Fan"],Lifestyle:["Active Lifestyle Seekers","Adventure Enthuasiasts","Health & Wellness Shoppers","Foodies","Travel & Experience Seekers","Fashion Icons"],Technology:["Tech & Gadget Enthuasiasts","Gadget Gurus","Online Shoppers"],Automotive:["Automative Ethuasiasts","Automative Intent"],Business:["Business & Professional","Corporate Visionaries","SME","Start-ups","Emerging Affluents"],Luxury:["Luxury Buyers","Luxury Seekers"],Family:["Family Dynamic ( Experienced Family )","Little Steps Advocates ( Young Family)","Mommy Pros ( Experienced Mother)","Youth Mom","The Dynamic Duo"],"Life Stage":["Students","Young Working Adult","Soloist"],"Home & Living":["Home Buyers","Eco Enthuasiasts"]},Nt=R=>{for(const[E,L]of Object.entries(wt))if(L.some(c=>R.includes(c)||c.includes(R)))return E;return"Other"},ks=({type:R})=>{const E={tv:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),sports:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),film:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"})}),newspaper:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"})}),sparkles:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),globe:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),user:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),users:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),video:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),youtube:e.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),facebook:e.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),instagram:e.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})}),tiktok:e.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"})})};return E[R]||E.globe};function Et(){var cs,ds,ms,hs,xs,us,gs,ps,fs,bs,vs,ys,js;const{id:R}=gt(),E=pt(),L=(cs=E.state)==null?void 0:cs.campaign,[c,z]=d.useState((L==null?void 0:L.currentStep)||1),[I,G]=d.useState([]),[t,T]=d.useState({campaignName:"",advertiserName:"",objective:"",industry:"",brandProduct:"",startDate:"",endDate:"",selectedPersonas:[],massTargeting:!1,targetLanguages:[],audienceIntent:"",audienceExclusions:"",demographicFilters:{race:[],generation:[],income:[]},audienceGroups:[],selectedStates:[],selectedFormats:[],totalBudget:"",budgetFlexibility:"fixed",buyingPreference:"no_preference",selectedSites:[],optimisedGroups:[],estimatedImpressions:0,budgetBreakdown:{}}),[C,g]=d.useState({}),[M,$]=d.useState([]),[W,_]=d.useState([]),[Y,Ls]=d.useState([]),[J,fe]=d.useState(""),[be,Ie]=d.useState(!1),[Ss,ve]=d.useState(!1),[Q,le]=d.useState(""),[ie,ye]=d.useState(null),[Ee,X]=d.useState(!1),[ce,ze]=d.useState([]),[We,Re]=d.useState(!1),[Cs,je]=d.useState(!1),[de,we]=d.useState(""),[Ne,Ge]=d.useState(!1),[Ms,$e]=d.useState(!1),[Fs,Oe]=d.useState(!1),[As,Bs]=d.useState(!1),[Ps,kt]=d.useState(""),[Lt,St]=d.useState(null),[Ts,ke]=d.useState(!1),[O,Is]=d.useState({title:"",message:"",confirmText:"OK",cancelText:"Cancel",onConfirm:null,type:"info"}),[q,re]=d.useState(null),[me,Le]=d.useState([]),[De,Ve]=d.useState(!1),[ee,_e]=d.useState({}),[Es,He]=d.useState(!1),[K,Ke]=d.useState({}),[Ct,Ue]=d.useState(!1),[ne,zs]=d.useState({}),[Mt,qe]=d.useState(!1),[F,H]=d.useState([]),[Ws,Ye]=d.useState(!1),[Rs,Gs]=d.useState({}),[Se,Ce]=d.useState("saved"),[Je,$s]=d.useState(null),[Ft,At]=d.useState(!1),[Ze,Os]=d.useState({"Display & Native":!0,"High Impact":!0,Video:!0,Interactive:!0,Social:!0}),[Ds,he]=d.useState(!1),[Qe,Xe]=d.useState(null),[Me,xe]=d.useState(""),[Vs,_s]=d.useState({"High Impact":!0,Video:!0,"Display & Native":!0,"Lead & Performance":!0,Interactive:!0,Social:!0}),Hs=s=>{_s(a=>({...a,[s]:!a[s]}))};d.useEffect(()=>{if(L){console.log("ðŸ“‚ Loading existing campaign:",L.campaignName),console.log("ðŸ“‚ Campaign data:",{objective:L.objective,industry:L.industry,brandProduct:L.brandProduct,totalBudget:L.totalBudget});const s={masthead:"fmt_6",leaderboard:"fmt_1",mrec:"fmt_2","half page":"fmt_3","mobile banner":"fmt_4","large mobile banner":"fmt_5",instream:"fmt_9","instream video":"fmt_9","in-stream video":"fmt_9",banner:"fmt_1",native:"fmt_1",interstitial:"fmt_24"},a=n=>{if(!n||n.length===0)return[];const l=n.map(i=>{if(typeof i=="string"&&i.startsWith("fmt_"))return console.log(`âœ… Keeping format ID: ${i}`),i;const b=i.toLowerCase(),v=s[b]||i;return console.log(`ðŸ”„ Migrating format: "${i}" â†’ "${v}"`),v});return console.log("ðŸ“¦ Migration complete:",{original:n,migrated:l}),l},r={...L,selectedPersonas:L.selectedPersonas||[],selectedFormats:a(L.selectedFormats),selectedSites:L.selectedSites||[],optimisedGroups:L.optimisedGroups||[],selectedStates:L.selectedStates||[],audienceGroups:L.audienceGroups||[],massTargeting:L.massTargeting??!1,targetLanguages:L.targetLanguages||[],demographicFilters:L.demographicFilters||{race:[],generation:[],income:[]}};console.log("ðŸ“‚ Setting campaignPlan state to:",{campaignName:r.campaignName,objective:r.objective,industry:r.industry,brandProduct:r.brandProduct,selectedFormats:r.selectedFormats}),console.log("ðŸ“‚ Selected formats from saved campaign:",r.selectedFormats),console.log("ðŸ”§ About to call setCampaignPlan with migrated formats"),T(r),console.log("âœ… setCampaignPlan called successfully"),L.budgetChannels&&L.budgetChannels.length>0&&H(L.budgetChannels);const o=L.currentStep||1;if(z(o),o>1){const n=Array.from({length:o-1},(l,i)=>i+1);G(n),console.log("âœ… Marked steps as completed:",n)}L.categoryFilters&&Os(L.categoryFilters),console.log("ðŸ“‚ Campaign loaded at step",o)}},[L]),d.useEffect(()=>{var r,o,n;const s=(r=E.state)==null?void 0:r.audienceGroup,a=(o=E.state)==null?void 0:o.fromAudienceSegments;s&&a&&(console.log("ðŸ‘¥ Loading audience group from Audience Segments:",s.name),console.log("ðŸ“Š Audience group data:",{personas:s.personas,reach:s.uniqueReach,industry:s.industry,objective:s.objective}),T(l=>({...l,industry:s.industry||l.industry,objective:s.objective||l.objective,selectedPersonas:s.personas||[],massTargeting:!1,demographicFilters:s.demographics||l.demographicFilters})),z(2),console.log(`âœ… Loaded ${((n=s.personas)==null?void 0:n.length)||0} personas from "${s.name}"`),window.history.replaceState({},document.title))},[E.state]),d.useEffect(()=>{if(!t.campaignName||!t.id)return;const s=setInterval(async()=>{try{Ce("saving"),console.log("ðŸ’¾ Auto-saving campaign..."),await U.put(`/api/campaigns/${t.id}`,{campaignPlan:{...t,budgetChannels:F,currentStep:c,categoryFilters:Ze},status:t.status||"draft"}),Ce("saved"),$s(new Date),console.log("âœ… Auto-save successful")}catch(a){Ce("error"),console.error("âŒ Auto-save failed:",a)}},3e4);return()=>clearInterval(s)},[t,F,c,Ze]),d.useEffect(()=>{Ie(!0),fetch("/api/audience").then(s=>s.json()).then(s=>{if(s.success&&s.data){_(s.data);const a=s.headers.filter(o=>o!=="Personas");Ls(a);const r=s.data.map(o=>({name:o.Personas,category:Nt(o.Personas),size:Ks(o)}));$(r),console.log("âœ… Loaded",r.length,"personas")}}).catch(s=>{console.error("âŒ Error loading personas:",s)}).finally(()=>{Ie(!1)})},[]),d.useEffect(()=>{He(!0),fetch("/api/formats").then(s=>s.json()).then(s=>{if(s.success&&s.data){const a={};s.data.forEach(o=>{if(!o.active)return;let n="Display & Native";const l=(o.type||"").toLowerCase(),i=(o.goal||"").toLowerCase(),b=(o.name||"").toLowerCase();b.includes("social ad")||b.includes("social video")?n="Social":l.includes("high impact")?n="High Impact":l.includes("video")||l.includes("instream")?n="Video":l.includes("interactive")||i.includes("lead")||i.includes("conversion")?n="Interactive":(i.includes("lead")||i.includes("form")||i.includes("capture"))&&(n="Lead & Performance"),a[n]||(a[n]=[]),a[n].push({id:o.id,name:o.name,description:o.description||"Premium ad format",bestFor:o.goal||"Various campaign objectives",tags:(o.goal||"Awareness").split(/[,&+/]/).map(v=>v.trim()).filter(v=>v),cpm:o.baseCpm,type:o.type})}),_e(a);const r=[];Object.values(a).forEach(o=>{o.forEach(n=>r.push(n.id))}),console.log("ðŸ“‹ Loaded formats from API:",{totalFormats:r.length,formatIds:r,currentSelectedFormats:t.selectedFormats})}}).catch(s=>{console.error("Error loading formats:",s),_e(jt)}).finally(()=>He(!1))},[t.selectedFormats]),d.useEffect(()=>{Ue(!0),fetch("/api/sites").then(s=>s.json()).then(s=>{if(s.success&&s.data){const a={...s.data,Social:ae.Social};Ke(a),console.log("âœ… Loaded sites from inventory:",s.total,"sites (Social platforms from static data)"),console.log("ðŸ“Š Sites breakdown:",{OTT:(a.OTT||[]).length+" sites",Web:(a.Web||[]).length+" sites",Social:(a.Social||[]).length+" sites"}),console.log("ðŸ“ OTT sites:",(a.OTT||[]).map(r=>r.name).join(", ")),console.log("ðŸ“ Web sites:",(a.Web||[]).map(r=>r.name).join(", ")),console.log("ðŸ“ Social sites:",(a.Social||[]).map(r=>r.name).join(", "))}}).catch(s=>{console.error("âŒ Error loading sites:",s),Ke(ae)}).finally(()=>Ue(!1))},[]),d.useEffect(()=>{qe(!0),fetch("/api/inventory/by-format").then(s=>s.json()).then(s=>{if(s.success&&s.formats){const a={};s.formats.forEach(r=>{const o=r.formatName.toLowerCase();a[o]={avgMonthlyRequests:r.avgMonthlyRequests,avgMonthlyImpressions:r.avgMonthlyImpressions,byLanguage:r.byLanguage,byProperty:r.byProperty}}),zs(a),console.log("âœ… Loaded format inventory for",Object.keys(a).length,"formats")}}).catch(s=>{console.error("âŒ Error loading format inventory:",s)}).finally(()=>qe(!1))},[]);const Ks=s=>{const a=Object.keys(s).filter(o=>!["Personas","Category","_id"].includes(o));let r=0;return a.forEach(o=>{const n=s[o];n&&typeof n=="string"&&(r+=parseInt(n.replace(/,/g,""),10)||0)}),r};d.useEffect(()=>{localStorage.setItem("kult_wizard_draft",JSON.stringify(t))},[t]),d.useEffect(()=>{if(L){console.log("ðŸ“‚ Skipping localStorage draft - loading existing campaign instead");return}const s=localStorage.getItem("kult_wizard_draft");if(s)try{console.log("ðŸ“‚ Loading draft from localStorage"),T(JSON.parse(s))}catch(a){console.error("Error loading draft:",a)}},[L]),d.useEffect(()=>{const s=a=>{q&&!a.target.closest(".relative")&&re(null)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[q]),d.useEffect(()=>{ue()},[]);const ue=async()=>{var s;Re(!0);try{const a=await U.get("/api/audience-groups");a.data.success&&(ze(a.data.data||[]),console.log("âœ… Loaded",((s=a.data.data)==null?void 0:s.length)||0,"saved audience groups"))}catch(a){console.error("Error loading audience groups:",a);const r=JSON.parse(localStorage.getItem("savedAudienceGroups")||"[]");ze(r)}finally{Re(!1)}},Us=async()=>{if(!de.trim()){alert("Please enter a name for this audience group");return}if(t.selectedPersonas.length===0){alert("Please select at least one persona before saving");return}Ge(!0);try{const s=t.selectedPersonas.reduce((o,n)=>{const l=W.find(i=>i.name===n);if(l){const b=Object.keys(l).filter(v=>v!=="id"&&v!=="name"&&v!=="description"&&v!=="category").reduce((v,j)=>{const p=l[j];return v+(typeof p=="number"?p:0)},0);return o+b}return o},0),a={id:`aud_group_${Date.now()}`,name:de.trim(),personas:t.selectedPersonas,uniqueReach:s,totalAudience:s,industry:t.industry||null,objective:t.objective||null,geography:t.selectedStates.join(", ")||"Malaysia",demographics:t.demographicFilters||{race:[],generation:[],income:[]},createdBy:JSON.parse(localStorage.getItem("user")||"{}").email||"User",createdAt:new Date().toISOString(),source:"campaign_wizard"};(await U.post("/api/audience-groups",a)).data.success&&(console.log("âœ… Audience group saved:",a.name),await ue(),je(!1),we(""),alert(`Audience group "${a.name}" saved successfully!`))}catch(s){console.error("Error saving audience group:",s),alert("Failed to save audience group. Please try again.")}finally{Ge(!1)}},qs=s=>{T(a=>({...a,selectedPersonas:s.personas||[],industry:s.industry||a.industry,objective:s.objective||a.objective,demographicFilters:s.demographics||{race:[],generation:[],income:[]}})),X(!1),console.log("âœ… Loaded audience group:",s.name,"with",s.personas.length,"personas"),alert(`Audience group "${s.name}" loaded successfully!`)},Ys=async s=>{if(confirm("Are you sure you want to delete this audience group?"))try{await U.delete(`/api/audience-groups/${s}`),await ue(),console.log("âœ… Deleted audience group:",s)}catch(a){console.error("Error deleting audience group:",a),alert("Failed to delete audience group. Please try again.")}};d.useEffect(()=>{if(console.log("ðŸ”„ USEEFFECT TRIGGERED:",JSON.stringify({"budgetChannels.length":F.length,"budgetChannels.names":F.map(n=>n.name),optimisedGroups:t.optimisedGroups},null,2)),F.length===0)return;if(!F.every(n=>n.hasOwnProperty("cpm")&&n.hasOwnProperty("budget")&&n.hasOwnProperty("impressions"))){console.log("âš ï¸ Skipping loading recalculation - channels missing required properties");return}Object.keys(K).length>0?Object.values(K).flat():Object.values(ae).flat();const a=n=>{const l=n.name.toLowerCase(),i=n.id.toLowerCase();return l.includes("ott")||l.includes("video")||i.includes("ott")||i.includes("video")?"OTT":l.includes("web")||l.includes("display")||l.includes("interactive")||i.includes("web")||i.includes("display")||i.includes("interactive")?"Web":l.includes("social")||i.includes("social")?"Social":"Web"};if(!F.some(n=>{const l=a(n),i=t.optimisedGroups.includes(l),b=l!=="Social"&&!i;return console.log(`ðŸ” NEEDS UPDATE CHECK for ${n.name}:`,JSON.stringify({channelCategory:l,optimisedGroups:t.optimisedGroups,isOptimized:i,shouldHaveLoading:b,"channel.hasLoading":n.hasLoading,needsUpdate:n.hasLoading!==b},null,2)),n.hasLoading!==b}))return;const o=F.map(n=>{const l=a(n),i=t.optimisedGroups.includes(l),b=l!=="Social"&&!i;if(n.hasLoading!==b){const v=n.baseCpm||(n.hasLoading?n.cpm/2:n.cpm),j=n.baseBudget||(n.hasLoading?n.budget/2:n.budget);console.log(`ðŸ” RECALC DEBUG for ${n.name}:`,JSON.stringify({"channel.baseCpm":n.baseCpm,"channel.cpm":n.cpm,"channel.hasLoading":n.hasLoading,"calculated baseCpm":v,shouldHaveLoading:b},null,2));const p=b?v*2:v,m=b?j*2:j,u=Math.round(m/p*1e3);return console.log(`ðŸ”„ Loading ${b?"APPLIED":"REMOVED"} for ${n.name}: CPM ${n.cpm||"N/A"} â†’ ${p}, Budget RM ${(n.budget||0).toLocaleString()} â†’ RM ${m.toLocaleString()}`),{...n,hasLoading:b,baseCpm:v,baseBudget:j,cpm:p,budget:m,impressions:u}}return n});console.log("âœ¨ Recalculated loading for all channels"),H(o)},[t.selectedSites.join(","),t.optimisedGroups.join(",")]);const es=[{num:1,name:"Campaign Info",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{num:2,name:"Audience",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})},{num:3,name:"Formats",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})})},{num:4,name:"Budget",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},{num:5,name:"Summary",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}],ss=s=>!!(s<=c||I.includes(s-1)),ts=()=>{if(t.massTargeting||!t.selectedPersonas||t.selectedPersonas.length===0)return 1;const s=1615e4;let a=0;t.selectedPersonas.forEach(o=>{const n=M.find(l=>l.name===o);n&&n.size&&(a+=n.size)});const r=a/s;return console.log("ðŸŽ¯ Persona Targeting Ratio:",{selectedPersonas:t.selectedPersonas,totalReach:a.toLocaleString(),basePopulation:s.toLocaleString(),ratio:`${(r*100).toFixed(1)}%`}),r},Fe=()=>{if(!t.selectedFormats||t.selectedFormats.length===0)return{totalRequests:0,totalImpressions:0,availableInventory:0,formats:[],personaRatio:1};const s=(t.targetLanguages||[]).map(p=>p.toLowerCase()),r=["bahasa malaysia","english","chinese"].every(p=>s.some(m=>m.includes(p.split(" ")[0])));let o=0,n=0;const l=[],i=ts();t.selectedFormats.forEach(p=>{const m=Object.values(ee||{}).flat().find(V=>V.id===p||V.name.toLowerCase().includes(p));if(!m)return;let u=m.name.toLowerCase();const x={leaderboard:"leaderboard",mrec:"mrec",masthead:"masthead","half page":"mrec","mobile banner":"leaderboard",interstitial:"interstitial","in-article":"in article","in-image":"in image",catfish:"catfish","instream video":"pre/midroll","in-stream video":"pre/midroll","pre-roll":"preroll","mid-roll":"midroll","image social ad":"social static ad","video social ad":"social video ad",skinner:"masthead",wallpaper:"masthead",takeover:"interstitial"},w=(m.type||"").toLowerCase().includes("interactive");let f=null,A=!1;if(w)A=!0;else if(f=ne[u],!f){for(const[V,Z]of Object.entries(x))if(u.includes(V)){f=ne[Z];break}}if(!f&&!A){console.warn(`âš ï¸ No inventory data found for format: ${m.name}`);return}let h=0,N=0;A?["leaderboard","mrec","masthead","interstitial","catfish","in article"].forEach(Z=>{const S=ne[Z];S&&(s.length===0||r?(h+=S.avgMonthlyRequests,N+=S.avgMonthlyImpressions):S.byLanguage.forEach(oe=>{const ws=oe.language.toLowerCase();s.some(ut=>ws.includes(ut)||ws.includes("multi"))&&(h+=oe.totalRequests/12,N+=oe.totalImpressions/12)}))}):s.length===0||r?(h=f.avgMonthlyRequests,N=f.avgMonthlyImpressions):f.byLanguage.forEach(V=>{const Z=V.language.toLowerCase();s.some(S=>Z.includes(S)||Z.includes("multi"))&&(h+=V.totalRequests/12,N+=V.totalImpressions/12)}),o+=h,n+=N;const te=(h-N)*.25*i;l.push({name:m.name,avgMonthlyRequests:Math.round(h),avgMonthlyImpressions:Math.round(N),availableInventory:Math.round(te)})});const j=(o-n)*.25*i;return{totalRequests:Math.round(o),totalImpressions:Math.round(n),availableInventory:Math.round(j),formats:l,personaRatio:i}},Js=()=>{const s={};switch(c){case 1:t.objective||(s.objective="Please select a primary objective"),t.industry||(s.industry="Please select an industry"),t.campaignName||(s.campaignName="Give this campaign a name so you can find it easily later");break;case 2:t.selectedPersonas.length===0&&(s.personas="Please select at least 1 persona");break;case 3:t.selectedFormats.length===0&&(s.formats="Please select at least 1 format"),t.objective==="Awareness"&&!t.selectedFormats.some(n=>["fmt_6","fmt_8","fmt_7","fmt_9","fmt_10"].includes(n))&&t.selectedFormats.length===1&&(s.formatsWarning="For awareness campaigns, add at least one video or high-impact format for meaningful visibility");break;case 4:const r=parseFloat(t.totalBudget);if((!t.totalBudget||isNaN(r)||r<=0)&&(s.totalBudget="Please enter a budget greater than 0"),r>0&&F.length>0){const o=F.reduce((l,i)=>l+(parseFloat(i.budget)||0),0),n=r-o;n<0&&(s.budgetAllocation=`Budget over-allocated by RM ${Math.abs(n).toLocaleString()}. Please reduce channel budgets or increase total budget.`)}if(r>0){const o=Fe(),n=5,l=r/n*1e3,i=o.availableInventory;if(i>0&&l>i*.8){const b=Math.round(i*n/1e3/r*100);b<20?s.totalBudget=`Selected formats have insufficient available inventory (${(i/1e6).toFixed(1)}M available). This budget would require ~${(l/1e6).toFixed(1)}M impressions. Please select formats with more inventory or reduce your budget to RM ${Math.round(i*n/1e3/1e3)*1e3}.`:b<50&&(s.budgetWarning=`Limited inventory alert: Selected formats have ~${(i/1e6).toFixed(1)}M available inventory. Consider selecting additional formats with higher inventory for optimal delivery.`)}r<2e4&&!s.budgetWarning&&!s.totalBudget&&(s.budgetWarning="Budgets under RM 20k may limit the number of channels and formats we can use")}t.selectedSites.length===0&&t.optimisedGroups.length===0&&(s.sites="Please select at least 1 site or enable 1 optimised group");break}return g(s),!Object.keys(s).some(r=>!r.includes("Warning"))},Zs=()=>{Js()&&(I.includes(c)||G([...I,c]),c===5?ht():c<5&&(z(c+1),window.scrollTo(0,0)))},Qs=()=>{c>1&&(console.log("ðŸ”™ Navigating back from step",c,"to",c-1),console.log("ðŸ“Š Available personas count:",M.length),console.log("ðŸ“Š Campaign plan state:",{personas:t.selectedPersonas.length,formats:t.selectedFormats.length,sites:t.selectedSites.length}),z(c-1),g({}),window.scrollTo(0,0))},Xs=s=>{if(console.log(`ðŸ”˜ Step ${s} clicked. Current step: ${c}`),ss(s))if(s<c){console.log(`â¬…ï¸ Going back from step ${c} to ${s}`);let a="";s===1?a="Going back to Campaign Info will clear all selections (Audiences, Formats, Sites, and Budget channels).":s===2?a="Going back to Audiences will clear Formats, Sites, and Budget channels.":s===3&&(a="Going back to Formats will clear Sites and Budget channels."),a?D({title:"Warning",message:`${a}

Do you want to continue?`,confirmText:"Continue",cancelText:"Cancel",type:"warning",onConfirm:()=>{as(s),z(s),g({}),window.scrollTo(0,0)}}):(as(s),z(s),g({}),window.scrollTo(0,0))}else z(s),g({}),window.scrollTo(0,0);else console.log(`âŒ Cannot navigate to step ${s}`)},as=s=>{console.log(`ðŸ—‘ï¸ Clearing data from steps after step ${s}`),s===1?(y({selectedPersonas:[],demographicFilters:{race:[],generation:[],income:[]},selectedStates:[],selectedFormats:[],selectedSites:[],optimisedGroups:[]}),H([]),G(I.filter(a=>a<=1))):s===2?(y({selectedFormats:[],selectedSites:[],optimisedGroups:[]}),H([]),G(I.filter(a=>a<=2))):s===3?(y({selectedSites:[],optimisedGroups:[]}),H([]),G(I.filter(a=>a<=3))):s===4&&G(I.filter(a=>a<=4))},D=({title:s,message:a,confirmText:r="OK",cancelText:o="Cancel",type:n="info",onConfirm:l})=>new Promise(i=>{Is({title:s,message:a,confirmText:r,cancelText:o,type:n,onConfirm:()=>{ke(!1),i(!0),l&&l()},onCancel:()=>{ke(!1),i(!1)}}),ke(!0)}),et=()=>{const{selectedPersonas:s,industry:a,selectedFormats:r,objective:o}=t;console.log("ðŸ” Site Filtering - Selected Formats:",r),console.log("ðŸ” Site Filtering - Full campaignPlan:",t);const n=Object.keys(K).length>0?K:ae,l={};Object.entries(n).forEach(([j,p])=>{l[j]=p.map(m=>{var k;let u=0,x=[];if(s.length>0){const w=s.join(" ").toLowerCase(),f=(m.tags||[]).join(" ").toLowerCase();w.includes("youth")&&f.includes("youth")&&(u+=20,x.push("Youth audience")),w.includes("women")&&f.includes("women")&&(u+=20,x.push("Women audience")),w.includes("family")&&(f.includes("entertainment")||f.includes("lifestyle"))&&(u+=15,x.push("Family-friendly")),w.includes("automotive")&&(f.includes("sports")||f.includes("news"))&&(u+=15,x.push("Automotive audience")),(m.tags||[]).forEach(A=>{w.includes(A.toLowerCase())&&(u+=5)})}if(a){const w=a.toLowerCase(),f=(m.tags||[]).join(" ").toLowerCase();w.includes("automotive")&&(f.includes("sports")||f.includes("news"))&&(u+=15,x.push("Automotive industry fit")),w.includes("fmcg")&&(f.includes("entertainment")||f.includes("lifestyle"))&&(u+=15,x.push("FMCG industry fit")),w.includes("beauty")&&f.includes("women")&&(u+=20,x.push("Beauty industry fit")),w.includes("tech")&&f.includes("news")&&(u+=10,x.push("Tech industry fit"))}if(r.length>0){const w=r.map(S=>Object.values(ee).flat().find(oe=>oe.id===S)).filter(Boolean),f=w.some(S=>S.type==="video"||S.name.toLowerCase().includes("video")),A=w.some(S=>S.type==="standard iab banner"||S.type==="high impact"||S.name.toLowerCase().includes("banner")||S.name.toLowerCase().includes("leaderboard")||S.name.toLowerCase().includes("mrec")),h=w.some(S=>S.type==="interactive banner"||S.name.toLowerCase().includes("interactive")||S.name.toLowerCase().includes("data capture")),N=((k=m.formats)==null?void 0:k.map(S=>S.toLowerCase()))||[],P=N.some(S=>S.includes("roll")||S.includes("video")),B=N.some(S=>S.includes("banner")||S.includes("leaderboard")||S.includes("mrec")||S.includes("masthead")||S.includes("catfish")),te=N.some(S=>S.includes("interstitial")||S.includes("interactive")||S.includes("in article")||S.includes("in image"));let V=0;f&&P&&(u+=50,x.push("âœ“ Supports video format"),V++),A&&B&&(u+=30,x.push("âœ“ Supports display format"),V++),h&&te&&(u+=35,x.push("âœ“ Supports interactive format"),V++),(f?1:0)+(A?1:0)+(h?1:0)>0&&V===0&&(u-=100,x.push("âœ— Does not support selected formats"))}if(t.targetLanguages&&t.targetLanguages.length>0){const w=(m.languages||[]).map(A=>A.toLowerCase());t.targetLanguages.some(A=>{const h=A.toLowerCase();return w.some(N=>N.includes(h)||N.includes("multi"))})?(u+=40,x.push("âœ“ Language match")):j==="Web"&&(u-=200,x.push("âœ— Language mismatch"))}if(o){const w=o.toLowerCase(),f=(m.tags||[]).join(" ").toLowerCase();w.includes("awareness")&&(j==="OTT"||f.includes("news"))&&(u+=10,x.push("Awareness objective fit")),(w.includes("conversion")||w.includes("lead"))&&j==="Social"&&(u+=15,x.push("Conversion objective fit"))}return((m.tags||[]).includes("News")||(m.tags||[]).includes("Premium"))&&(u+=10),{...m,relevanceScore:u,relevanceReasons:x}}).sort((m,u)=>u.relevanceScore-m.relevanceScore)}),r.length>0&&Object.entries(l).forEach(([j,p])=>{const m=p.slice(0,3);console.log(`ðŸ“Š ${j} Channel - Top 3 Sites:`,m.map(u=>({name:u.name,score:u.relevanceScore,reasons:u.relevanceReasons,formats:u.formats})))});const i=s.length>0||a||r.length>0;if(!i)return Object.keys(K).length>0?K:ae;const b={};if(r.length>0){const j=r.map(x=>Object.values(ee).flat().find(k=>k.id===x)).filter(Boolean),p=j.some(x=>{const k=x.name.toLowerCase(),w=(x.type||"").toLowerCase();return k.includes("social")?!1:w==="video"||k.includes("instream")||k.includes("pre-roll")||k.includes("mid-roll")||k.includes("preroll")||k.includes("midroll")}),m=j.some(x=>{const k=x.name.toLowerCase(),w=(x.type||"").toLowerCase();return k.includes("social")?!1:w==="standard iab banner"||w==="high impact"||w==="interactive banner"||k.includes("banner")||k.includes("leaderboard")||k.includes("mrec")||k.includes("masthead")||k.includes("display")||k.includes("skyscraper")||k.includes("half page")}),u=j.some(x=>{const k=x.name.toLowerCase(),w=(x.type||"").toLowerCase();return k.includes("social")||k.includes("stories")||k.includes("story")||k.includes("reel")||k.includes("tiktok")||k.includes("carousel")||k.includes("feed")||k.includes("instagram")||k.includes("facebook")||k.includes("snapchat")||w==="static image"});console.log("ðŸŽ¯ Smart Channel Filtering:",{hasVideoFormat:p,hasDisplayFormat:m,hasSocialFormat:u,selectedFormats:j.map(x=>({name:x.name,type:x.type,id:x.id}))}),Object.entries(l).forEach(([x,k])=>{let w=!1;if(x==="OTT"?w=p:x==="Web"?w=p||m:x==="Social"?w=u:w=k.filter(h=>h.relevanceScore>0).length>0,w){const A=k.filter(h=>h.relevanceScore>0);A.length>0&&(b[x]=A)}})}else Object.entries(l).forEach(([j,p])=>{b[j]=p});if(Object.keys(b).length===0&&i){const j=Object.entries(l).sort((p,m)=>{const u=Math.max(...p[1].map(k=>k.relevanceScore));return Math.max(...m[1].map(k=>k.relevanceScore))-u})[0];j&&(b[j[0]]=j[1])}return r.some(j=>{const p=Object.values(ee).flat().find(m=>m.id===j);return p&&(p.name.toLowerCase().includes("social")||p.type==="static image")})&&(b.Social=[{id:"social_facebook",name:"Facebook",category:"Social Media",description:"World's largest social network with 2.9B+ monthly active users",traffic:"2.9B",tags:["Social","All Demographics","Global Reach","Image Ads","Video Ads"],formats:["Static Image","Vertical Video","Carousel","Stories"],icon:"social",relevanceScore:100,relevanceReasons:["Supports social formats","Global reach","All demographics"]},{id:"social_instagram",name:"Instagram",category:"Social Media",description:"Visual-first platform popular with younger audiences, 2B+ users",traffic:"2.0B",tags:["Social","Youth","Millennials","Visual Content","Image Ads","Video Ads"],formats:["Static Image","Vertical Video","Stories","Reels"],icon:"social",relevanceScore:95,relevanceReasons:["Supports social formats","Youth audience","Visual focus"]},{id:"social_tiktok",name:"TikTok",category:"Social Media",description:"Short-form video platform, dominant with Gen Z, 1B+ users",traffic:"1.0B",tags:["Social","Gen Z","Youth","Video First","Viral Content"],formats:["Vertical Video","In-Feed Ads","Top View"],icon:"social",relevanceScore:90,relevanceReasons:["Supports social formats","Gen Z audience","Video focus"]}]),b},y=s=>{if("optimisedGroups"in s&&console.log("ðŸ”§ updatePlan changing optimisedGroups:",JSON.stringify({from:t.optimisedGroups,to:s.optimisedGroups,stackTrace:new Error().stack.split(`
`).slice(2,5).join(`
`)},null,2)),"endDate"in s||"startDate"in s){const a=s.startDate||t.startDate,r=s.endDate||t.endDate;if(a&&r&&r<a){g(o=>({...o,endDate:"End date cannot be earlier than start date"}));return}else g(o=>{const n={...o};return delete n.endDate,n})}T(a=>({...a,...s}))},rs=s=>{const a=t.selectedPersonas;console.log("ðŸ”„ Persona changed, clearing Formats, Sites and Budget channels"),a.includes(s)?y({selectedPersonas:a.filter(r=>r!==s),selectedFormats:[],selectedSites:[],optimisedGroups:[]}):y({selectedPersonas:[...a,s],selectedFormats:[],selectedSites:[],optimisedGroups:[]}),H([])},st=s=>{const a=t.selectedFormats;console.log("ðŸ”„ FORMAT CHANGED v3.43.0 - Clearing Sites and Budget channels"),a.includes(s)?y({selectedFormats:a.filter(r=>r!==s),selectedSites:[],optimisedGroups:[]}):y({selectedFormats:[...a,s],selectedSites:[],optimisedGroups:[]}),H([])},tt=s=>{const a=t.selectedSites;a.includes(s)?y({selectedSites:a.filter(r=>r!==s)}):y({selectedSites:[...a,s]})},at=s=>{const a=t.optimisedGroups;a.includes(s)?y({optimisedGroups:a.filter(r=>r!==s)}):y({optimisedGroups:[...a,s]})},rt=(s,a)=>{const r=a.map(l=>l.id),o=t.selectedSites;if(r.every(l=>o.includes(l)))y({selectedSites:o.filter(l=>!r.includes(l)),optimisedGroups:t.optimisedGroups.filter(l=>l!==s)});else{const l=[...new Set([...o,...r])];y({selectedSites:l})}},ns=s=>{Gs(a=>({...a,[s]:!a[s]}))},nt=(s,a)=>{H(r=>r.map(o=>{if(o.id===s){const n=Math.max(0,parseFloat(a)||0),l=Math.round(n/o.cpm*1e3);return{...o,budget:n,impressions:l}}return o}))},se=()=>{const s=parseFloat(t.totalBudget)||0,a=F.reduce((r,o)=>r+o.budget,0);return s-a},ge=()=>{const s=parseFloat(t.totalBudget)||0;if(s===0)return 0;const a=F.reduce((r,o)=>r+o.budget,0);return Math.min(100,a/s*100)},ot=s=>{var j,p;console.log("ðŸ” DEBUG - addChannelFromRecommendation called with:",{id:s.id,name:s.name,recommendationCpm:s.cpm,recommendationStatsCpm:(j=s.stats)==null?void 0:j.cpm,recommendationCost:s.cost});let a=s.cost||0;const r=a,o=s.cpm||((p=s.stats)==null?void 0:p.cpm)||50;let n=o,l=!1;console.log(`ðŸ” DEBUG - Extracted values: baseCpm=${o}, budget=${a}`);const i=s.id.includes("ott")||s.name.toLowerCase().includes("ott")||s.id.includes("video")||s.name.toLowerCase().includes("video")?"OTT":s.id.includes("web")||s.name.toLowerCase().includes("web")||s.name.toLowerCase().includes("display")||s.id.includes("interactive")||s.name.toLowerCase().includes("interactive")?"Web":s.id.includes("social")?"Social":"Web";i!=="Social"?t.optimisedGroups.includes(i)?console.log(`âœ… ${i} channel IS optimized: No loading applied to ${s.name} (Budget: RM ${a.toLocaleString()}, CPM: ${n})`):(a=a*2,n=n*2,l=!0,console.log(`ðŸ’° ${i} channel NOT optimized: Applied 100% loading to ${s.name} (Budget: RM ${r.toLocaleString()} â†’ RM ${a.toLocaleString()}, CPM: ${o} â†’ ${n})`)):i==="Social"&&console.log(`âœ… Social channel: No loading applied (always base rate) to ${s.name} (Budget: RM ${a.toLocaleString()}, CPM: ${n})`);const b=Math.round(a/n*1e3),v={id:s.id,name:s.name,budget:a,cpm:n,baseCpm:o,baseBudget:r,impressions:b,weight:s.weight,hasLoading:l,color:s.id.includes("ott")||s.id.includes("video")?"bg-green-500":s.id.includes("social")?"bg-blue-500":"bg-purple-500"};console.log("âœ… DEBUG - newChannel created:",{id:v.id,name:v.name,baseCpm:v.baseCpm,cpm:v.cpm,budget:v.budget,hasLoading:v.hasLoading}),H(m=>m.find(x=>x.id===s.id)?m.map(x=>x.id===s.id?v:x):[...m,v])};d.useEffect(()=>{if(!R&&c===4&&t.selectedFormats.length===0){const s=t.objective;let a=[];s==="Awareness"||s==="Brand building"?a=["fmt_6","fmt_9","fmt_1","fmt_2"]:s==="Traffic"||s==="Engagement"?a=["fmt_1","fmt_2","fmt_29","fmt_10"]:(s==="Lead generation"||s==="Sales / Conversions")&&(a=["fmt_20","fmt_25","fmt_1","fmt_2"]),y({selectedFormats:a})}},[c,t.objective,R]),d.useEffect(()=>{const s=parseFloat(t.totalBudget)||0;if(s>0)if(F&&F.length>0){const a=F.reduce((r,o)=>r+(o.impressions||0),0);console.log(`ðŸ’° Using Step 4 budget allocation: ${(a/1e6).toFixed(1)}M impressions from ${F.length} channels`),y({estimatedImpressions:a})}else(async()=>{try{const r=await U.post("/api/calculate-impressions",{budget:s,selectedFormatIds:t.selectedFormats||[]});r.data.success&&(console.log(`ðŸ“Š Calculated from formats: ${(r.data.impressions/1e6).toFixed(1)}M impressions`),y({estimatedImpressions:r.data.impressions}))}catch(r){console.error("[CALCULATE IMPRESSIONS ERROR]:",r.message);const n=Math.round(s/12*1e3);y({estimatedImpressions:n})}})()},[t.totalBudget,t.selectedFormats,F]);const pe=s=>s>=1e6?(s/1e6).toFixed(2)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":s.toString(),Ae=()=>{var u,x,k,w,f,A;const s=t.selectedPersonas;if(console.log("=== Overlap Calculation Start ==="),console.log("Selected personas:",s),console.log("Available personas count:",M.length),console.log("Available personas sample:",M.slice(0,3).map(h=>({name:h.name,size:h.size}))),s.length===0)return console.log("No personas selected, returning null"),null;let a=1;if(console.log("Demographic filters:",t.demographicFilters),((x=(u=t.demographicFilters)==null?void 0:u.race)==null?void 0:x.length)>0){const h=t.demographicFilters.race.reduce((N,P)=>{const B=Te.Race[P]||0;return console.log(`Race ${P}: ${B} (${B*100}%)`),N+B},0);console.log("Race multiplier:",h),a*=h}if(((w=(k=t.demographicFilters)==null?void 0:k.generation)==null?void 0:w.length)>0){const h=t.demographicFilters.generation.reduce((N,P)=>{const B=Te.Generation[P]||0;return console.log(`Generation ${P}: ${B} (${B*100}%)`),N+B},0);console.log("Generation multiplier:",h),a*=h}if(((A=(f=t.demographicFilters)==null?void 0:f.income)==null?void 0:A.length)>0){const h=t.demographicFilters.income.reduce((N,P)=>{const B=Te.Income[P]||0;return console.log(`Income ${P}: ${B} (${B*100}%)`),N+B},0);console.log("Income multiplier:",h),a*=h}console.log("Final demographic multiplier:",a);let r=1;if(t.selectedStates.length>0&&t.selectedStates.length<Y.length&&W.length>0&&Y.length>0){const h=W[0];let N=0,P=0;Y.forEach(B=>{const te=parseFloat(String(h[B]||"0").replace(/,/g,""));P+=te,t.selectedStates.includes(B)&&(N+=te)}),P>0&&(r=N/P)}const o=s.map(h=>{let N=M.find(B=>B.name===h);if(!N)if(N=M.find(B=>B.name.toLowerCase().includes(h.toLowerCase())||h.toLowerCase().includes(B.name.toLowerCase())),N)console.log(`ðŸ“ Fuzzy match found: "${h}" â†’ "${N.name}"`);else return console.warn(`Persona not found: ${h} (tried fuzzy matching)`),{name:h,size:0,originalSize:0,category:"Unknown"};const P=Math.round(N.size*a*r);return console.log("Overlap calculation:",{persona:h,originalSize:N.size,demographicMultiplier:a,geographyMultiplier:r,adjustedSize:P,selectedStates:t.selectedStates.length,audienceDataLoaded:W.length>0}),{name:h,size:P,originalSize:N.size,category:N.category||"Unknown"}}).filter(h=>h.size>0);if(o.length===0)return console.warn("No personas found for overlap calculation"),null;const n=o.reduce((h,N)=>h+N.size,0),l=86375180,i=1615e4;if(t.massTargeting){const h=Math.round(l*a*r),N=Math.round(i*a*r),P=h-N,B=h>0?Math.round(P/h*100):0;return{personas:o,totalRaw:h,overlapPercent:B,estimatedOverlap:P,uniqueReach:N,demographicMultiplier:a,geographyMultiplier:r,isMassTargeting:!0}}if(o.length===1)return{personas:o,totalRaw:n,overlapPercent:0,estimatedOverlap:0,uniqueReach:n,demographicMultiplier:a};let b=0,v=0;for(let h=0;h<o.length;h++)for(let N=h+1;N<o.length;N++){const P=o[h].category===o[N].category;b+=P?.6:.25,v++}const j=v>0?b/v:0,p=Math.round(n*j),m=n-p;return{personas:o,totalRaw:n,overlapPercent:Math.round(j*100),estimatedOverlap:p,uniqueReach:m,demographicMultiplier:a}},lt=async()=>{if(!Q.trim()){D({title:"Missing Group Name",message:"Please enter a group name",confirmText:"OK",cancelText:null,type:"warning"});return}if(t.selectedPersonas.length===0){D({title:"No Personas Selected",message:"Please select at least one persona",confirmText:"OK",cancelText:null,type:"warning"});return}const s=Ae(),a=s?s.uniqueReach:0,r=s?s.totalReach:0,o={id:Date.now().toString(),name:Q.trim(),personas:[...t.selectedPersonas],demographicFilters:{...t.demographicFilters},selectedStates:[...t.selectedStates],uniqueReach:a,createdAt:new Date().toISOString()};try{const n={name:Q.trim(),personas:[...t.selectedPersonas],demographics:{...t.demographicFilters},totalAudience:r,uniqueReach:a,industry:t.industry||"",objective:t.objective||"",geography:t.selectedStates.length===Y.length?"Nationwide":t.selectedStates.join(", "),createdBy:"Build Plan Wizard"},l=await U.post("/api/audience-groups",n);console.log("âœ… Saved audience group to backend:",l.data),D({title:"Audience Group Saved",message:`"${Q.trim()}" has been saved and is now available in the Audience Segments page.`,confirmText:"OK",cancelText:null,type:"info"})}catch(n){console.error("âŒ Error saving audience group to backend:",n);const l=JSON.parse(localStorage.getItem("savedAudienceGroups")||"[]");l.push({...o,industry:t.industry,objective:t.objective,geography:t.selectedStates.join(", ")}),localStorage.setItem("savedAudienceGroups",JSON.stringify(l)),console.log("âœ… Saved audience group to localStorage as fallback"),D({title:"Audience Group Saved Locally",message:`"${Q.trim()}" has been saved locally. It will sync to the server when available.`,confirmText:"OK",cancelText:null,type:"info"})}if(ie!==null){const n=[...t.audienceGroups];n[ie]={...n[ie],...o},y({audienceGroups:n})}else y({audienceGroups:[...t.audienceGroups,o]});le(""),ye(null),ve(!1)},it=s=>{y({selectedPersonas:[...s.personas],demographicFilters:{...s.demographicFilters},selectedStates:s.selectedStates?[...s.selectedStates]:[]})},ct=s=>{D({title:"Delete Audience Group",message:"Are you sure you want to delete this audience group?",confirmText:"Delete",cancelText:"Cancel",type:"danger",onConfirm:()=>{const a=t.audienceGroups.filter((r,o)=>o!==s);y({audienceGroups:a})}})},os=d.useCallback(async()=>{if(c<2||c>5){Le([]);return}Ve(!0);try{const a={2:"audience",3:"formats",4:"budget",5:"overview"}[c],r={advertiserName:t.campaignName,product_brand:t.brandProduct,campaign_objective:t.objective,industry:t.industry,budget_rm:parseInt(t.totalBudget)||1e5};console.log("ðŸ¤– Fetching AI recommendations:",{step:a,objective:t.objective,industry:t.industry,currentStep:c,hasFormats:t.selectedFormats.length>0});const o=await U.post("/api/ai-recommendations/generate",{brief:r,step:a,currentSelections:{audiences:t.selectedPersonas,formats:t.selectedFormats,sites:t.selectedSites,budgetChannels:F}});o.data.success&&(console.log("âœ… AI recommendations received:",o.data.recommendations.length),Le(o.data.recommendations))}catch(s){console.error("âŒ Error fetching AI recommendations:",s),Le([])}finally{Ve(!1)}},[c,t.campaignName,t.objective,t.industry,t.totalBudget,t.selectedPersonas,t.selectedFormats,t.selectedSites]);d.useEffect(()=>{console.log("ðŸ“Š campaignPlan state updated:",{name:t.campaignName,objective:t.objective,industry:t.industry,brandProduct:t.brandProduct})},[t.campaignName,t.objective,t.industry,t.brandProduct]),d.useEffect(()=>{const s=setTimeout(()=>{c>=2&&c<=5&&(t.objective&&t.industry?(console.log("ðŸ¤– Fetching AI recommendations with campaign data:",{name:t.campaignName||"(new)",objective:t.objective,industry:t.industry,step:c,formats:t.selectedFormats.length}),os()):console.log("â¸ï¸ Skipping AI fetch - campaignPlan state:",{name:t.campaignName,objective:t.objective,industry:t.industry,hasObjective:!!t.objective,hasIndustry:!!t.industry}))},100);return()=>clearTimeout(s)},[c,t.campaignName,t.objective,t.industry,t.selectedFormats.length,os]);const ls=s=>{s.type==="audience"?t.selectedPersonas.includes(s.name)?y({selectedPersonas:t.selectedPersonas.filter(a=>a!==s.name)}):y({selectedPersonas:[...t.selectedPersonas,s.name]}):s.type==="format"?t.selectedFormats.includes(s.id)?y({selectedFormats:t.selectedFormats.filter(a=>a!==s.id)}):y({selectedFormats:[...t.selectedFormats,s.id]}):s.type==="site"?t.selectedSites.includes(s.id)?y({selectedSites:t.selectedSites.filter(a=>a!==s.id)}):y({selectedSites:[...t.selectedSites,s.id]}):s.type==="budget"&&(F.find(r=>r.id===s.id)?(H(r=>r.filter(o=>o.id!==s.id)),console.log(`ðŸ—‘ï¸ Removed budget channel: ${s.name}`)):(ot(s),console.log(`âž• Added budget channel: ${s.name}`)))},dt=async()=>{try{const s=await U.post("/api/export/kult-template",{campaignPlan:t,budgetChannels:F,availableSites:K,campaignName:t.campaignName||"Campaign Plan"},{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([s.data])),r=document.createElement("a");r.href=a,r.setAttribute("download",`KULT_${t.campaignName||"Campaign_Plan"}_${Date.now()}.xlsx`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(a),D({title:"Success",message:"KULT Media Plan downloaded successfully!",confirmText:"OK",cancelText:null,type:"info"})}catch(s){console.error("Export Excel error:",s),D({title:"Export Failed",message:"Failed to export Excel file. Please try again.",confirmText:"OK",cancelText:null,type:"danger"})}},mt=async()=>{D({title:"Generating PDF...",message:"Please wait while we generate your media plan PDF (10-15 seconds). Do not close this window.",confirmText:null,cancelText:null,type:"info"});try{const s=await U.post("/api/export/kult-template-pdf",{campaignPlan:t,budgetChannels:F,availableSites:K,campaignName:t.campaignName||"Campaign Plan"},{responseType:"blob",timeout:6e4}),a=window.URL.createObjectURL(new Blob([s.data],{type:"application/pdf"})),r=document.createElement("a");r.href=a,r.setAttribute("download",`KULT_${t.campaignName||"Campaign_Plan"}_${Date.now()}.pdf`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(a),D({title:"Success",message:"KULT Media Plan PDF downloaded successfully!",confirmText:"OK",cancelText:null,type:"info"})}catch(s){console.error("Export PDF error:",s),D({title:"Export Failed",message:"Failed to export PDF file. Please try again.",confirmText:"OK",cancelText:null,type:"danger"})}},Be=async()=>{if(console.log("ðŸ’¾ handleSaveDraft called. Campaign ID:",t.id),t.id){console.log("ðŸ“ Existing campaign detected, showing save dialog"),Xe("draft"),xe(`${t.campaignName} (v${Date.now()})`),he(!0);return}console.log("ðŸ†• New campaign, saving directly"),await Pe("draft",!1)},Pe=async(s,a)=>{try{const r=t.id&&!a,o={campaignPlan:{...t,...a&&{campaignName:Me,id:void 0},budgetChannels:F,currentStep:c},status:s==="draft"?"draft":"booked"};let n;r?n=await U.put(`/api/campaigns/${t.id}`,o):n=await U.post("/api/campaigns",o),n.data.success&&(r||y({id:n.data.campaign.id,...a&&{campaignName:Me}}),s==="draft"?$e(!0):Oe(!0),he(!1))}catch(r){console.error("Save error:",r),D({title:"Save Failed",message:"Failed to save. Please try again.",confirmText:"OK",cancelText:null,type:"danger"})}};d.useEffect(()=>{const s=async()=>{console.log("ðŸ’¾ Save draft and reset triggered from navigation"),(t.campaignName||t.selectedPersonas.length>0)&&await Be(),handleClearData(),z(1)},a=()=>{console.log("ðŸ”„ Reset build plan triggered from navigation"),handleClearData(),z(1)};return window.addEventListener("saveDraftAndReset",s),window.addEventListener("resetBuildPlan",a),()=>{window.removeEventListener("saveDraftAndReset",s),window.removeEventListener("resetBuildPlan",a)}},[t.campaignName,t.selectedPersonas.length]);const ht=async()=>{if(!t.id){D({title:"Save Required",message:"Please save as draft first before booking.",confirmText:"OK",cancelText:null,type:"warning"});return}D({title:"Book this campaign now?",message:`This will submit your booking to the sales team for processing. They will be notified and will contact you to confirm the booking.

You can still edit it later if needed.`,confirmText:"OK",cancelText:"Cancel",type:"info",onConfirm:()=>{Xe("book"),xe(`${t.campaignName} (v${Date.now()})`),he(!0)}})},xt=()=>t.selectedPersonas.length>0&&t.totalBudget&&t.selectedFormats.length>0&&t.selectedSites.length>0,is=()=>c===2?t.selectedPersonas:c===3?t.selectedFormats:c===4?[...F.filter(s=>s.budget>0).map(s=>s.id),...t.selectedSites]:[];return e.jsx(bt,{children:e.jsxs("div",{className:"min-h-screen bg-[#0a0a0a] text-gray-100",children:[e.jsxs("div",{className:"border-b border-gray-800 bg-[#0f0f0f] px-4 sm:px-6 lg:px-8 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-cyan-400 font-semibold mb-1 tracking-wider",children:"[ BUILD YOUR PLAN ]"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Campaign Planner Wizard"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[t.id&&e.jsxs("div",{className:"flex items-center gap-2",children:[Se==="saving"&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Saving..."})]}),Se==="saved"&&Je&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-400",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsxs("span",{children:["Saved ",new Date(Je).toLocaleTimeString()]})]}),Se==="error"&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-400",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"Save failed"})]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Step ",c," of 5"]})]})]}),e.jsx("div",{className:"mt-4 w-full h-1 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-purple-600 transition-all duration-300",style:{width:`${c/6*100}%`}})})]}),e.jsx("div",{className:"border-b border-gray-800 bg-[#0f0f0f] px-4 sm:px-6 lg:px-8 py-4 overflow-x-auto",children:e.jsx("div",{className:"flex items-center justify-between min-w-max",children:es.map((s,a)=>{const r=s.num===c,o=I.includes(s.num),n=ss(s.num);return e.jsxs(ft.Fragment,{children:[e.jsxs("button",{onClick:()=>Xs(s.num),disabled:!n,className:`flex items-center gap-3 px-4 py-2 rounded-lg transition-all ${r?"bg-cyan-900/30 border-2 border-cyan-500 shadow-lg shadow-cyan-500/20":o?"bg-green-900/20 border border-green-700 hover:bg-green-900/30":n?"border border-gray-700 hover:border-gray-600":"border border-gray-800 opacity-50 cursor-not-allowed"}`,children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full ${r?"bg-cyan-500 text-white":o?"bg-green-600 text-white":"bg-gray-800 text-gray-500"}`,children:o?e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):s.icon}),e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:`text-xs ${r?"text-cyan-400":"text-gray-500"}`,children:["Step ",s.num]}),e.jsx("div",{className:`text-sm font-semibold ${r?"text-white":o?"text-gray-300":"text-gray-500"}`,children:s.name})]})]}),a<es.length-1&&e.jsx("div",{className:"flex-shrink-0 w-12 h-0.5 bg-gray-800 mx-2"})]},s.num)})})}),e.jsxs("div",{className:"flex gap-6 p-4 sm:p-6 lg:p-8",children:[e.jsxs("div",{className:"flex-1 max-w-4xl pb-56",children:[c===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"1. Tell us about your campaign"}),(t.campaignName||t.advertiserName||t.objective||t.industry||t.brandProduct||t.startDate||t.endDate)&&e.jsxs("button",{onClick:()=>{T(s=>({...s,campaignName:"",advertiserName:"",objective:"",industry:"",brandProduct:"",startDate:"",endDate:""})),console.log("ðŸ—‘ï¸ Step 1: All campaign details cleared")},className:"px-4 py-2 bg-red-900/20 hover:bg-red-900/40 border border-red-700 hover:border-red-600 rounded-lg text-sm font-medium text-red-400 hover:text-red-300 transition-colors flex items-center gap-2",title:"Clear all campaign details",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Clear All"]})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"We'll start with the basics. You can refine details later, but we need at least an objective and an industry to use the right playbook."})]}),e.jsxs("div",{className:"space-y-6 bg-[#0f0f0f] border border-gray-800 rounded-xl p-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Campaign name"}),e.jsx("input",{type:"text",value:t.campaignName,onChange:s=>y({campaignName:s.target.value}),placeholder:"E.g. New SUV launch Q3 2026",className:`w-full px-4 py-3 bg-[#1a1a1a] border ${C.campaignName?"border-yellow-500":"border-gray-700"} rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyan-500`}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use a name your sales team and client will recognise later."}),C.campaignName&&e.jsxs("p",{className:"text-xs text-yellow-400 mt-1 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),C.campaignName]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Advertiser name"}),e.jsx("input",{type:"text",value:t.advertiserName,onChange:s=>y({advertiserName:s.target.value}),placeholder:"E.g. McDonald's, Toyota, Maybank",className:"w-full px-4 py-3 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyan-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"The company or brand name running this campaign."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-white mb-2",children:["Primary objective ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:t.objective,onChange:s=>y({objective:s.target.value}),className:`w-full px-4 py-3 bg-[#1a1a1a] border ${C.objective?"border-red-500":"border-gray-700"} rounded-lg text-white focus:outline-none focus:border-cyan-500`,children:[e.jsx("option",{value:"",children:"Select objective..."}),e.jsx("option",{value:"Awareness",children:"Awareness"}),e.jsx("option",{value:"Traffic",children:"Traffic"}),e.jsx("option",{value:"Engagement",children:"Engagement"}),e.jsx("option",{value:"Lead generation",children:"Lead generation"}),e.jsx("option",{value:"Sales / Conversions",children:"Sales / Conversions"}),e.jsx("option",{value:"Brand building",children:"Brand building"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Pick the main outcome. The planner will adjust formats and channels around this."}),C.objective&&e.jsxs("p",{className:"text-xs text-red-400 mt-1 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),C.objective]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-white mb-2",children:["Industry ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:t.industry,onChange:s=>y({industry:s.target.value}),className:`w-full px-4 py-3 bg-[#1a1a1a] border ${C.industry?"border-red-500":"border-gray-700"} rounded-lg text-white focus:outline-none focus:border-cyan-500`,children:[e.jsx("option",{value:"",children:"Select industry..."}),e.jsx("option",{value:"automotive_ice",children:"Automotive (ICE)"}),e.jsx("option",{value:"automotive_ev",children:"Automotive (EV)"}),e.jsx("option",{value:"property_luxury",children:"Property (Luxury)"}),e.jsx("option",{value:"property_mid_range",children:"Property (Mid-Range)"}),e.jsx("option",{value:"property_affordable",children:"Property (Affordable)"}),e.jsx("option",{value:"fmcg",children:"FMCG"}),e.jsx("option",{value:"beauty",children:"Beauty & Cosmetics"}),e.jsx("option",{value:"retail_ecommerce",children:"Retail / eCommerce"}),e.jsx("option",{value:"telco",children:"Telco"}),e.jsx("option",{value:"finance_insurance",children:"Finance / Insurance"}),e.jsx("option",{value:"banking_fintech",children:"Banking / Fintech"}),e.jsx("option",{value:"tourism",children:"Tourism"}),e.jsx("option",{value:"tech_devices",children:"Tech & Devices"}),e.jsx("option",{value:"sme_b2b",children:"SME / B2B"}),e.jsx("option",{value:"entertainment_ott",children:"Entertainment / OTT"}),e.jsx("option",{value:"gaming",children:"Gaming"}),e.jsx("option",{value:"luxury",children:"Luxury"}),e.jsx("option",{value:"media_entertainment",children:"Media / Entertainment"}),e.jsx("option",{value:"professional_services",children:"Professional Services"}),e.jsx("option",{value:"education",children:"Education"}),e.jsx("option",{value:"f_and_b",children:"F&B"}),e.jsx("option",{value:"lifestyle",children:"Lifestyle"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This connects to the KULT industry playbook to auto-suggest audiences and formats."}),C.industry&&e.jsxs("p",{className:"text-xs text-red-400 mt-1 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),C.industry]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Brand / product line"}),e.jsx("input",{type:"text",value:t.brandProduct,onChange:s=>y({brandProduct:s.target.value}),placeholder:"E.g. Brand X â€“ EV sedan, Brand Y â€“ collagen drink",className:"w-full px-4 py-3 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyan-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Short description of what we are advertising."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Planned flight dates (optional)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Start date"}),e.jsx("input",{type:"date",value:t.startDate,onChange:s=>y({startDate:s.target.value}),className:"w-full px-4 py-2.5 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"End date"}),e.jsx("input",{type:"date",value:t.endDate,min:t.startDate||void 0,onChange:s=>y({endDate:s.target.value}),className:`w-full px-4 py-2.5 bg-[#1a1a1a] border rounded-lg text-white focus:outline-none ${C.endDate?"border-red-500 focus:border-red-500":"border-gray-700 focus:border-cyan-500"}`}),C.endDate&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:C.endDate})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"If dates are not confirmed, you can skip this. We'll still estimate weekly pacing."})]})]})]}),c===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"2. Who are you trying to reach?"}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.selectedPersonas.length>0&&e.jsxs("button",{onClick:()=>je(!0),className:"px-4 py-2 bg-cyan-900/20 hover:bg-cyan-900/40 border border-cyan-700 hover:border-cyan-600 rounded-lg text-sm font-medium text-cyan-400 hover:text-cyan-300 transition-colors flex items-center gap-2",title:"Save current audience selection",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"Save Audience"]}),e.jsxs("button",{onClick:()=>X(!0),className:"px-4 py-2 bg-purple-900/20 hover:bg-purple-900/40 border border-purple-700 hover:border-purple-600 rounded-lg text-sm font-medium text-purple-400 hover:text-purple-300 transition-colors flex items-center gap-2",title:"Load a saved audience group",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Load Saved"]}),(t.selectedPersonas.length>0||t.massTargeting||((ms=(ds=t.demographicFilters)==null?void 0:ds.race)==null?void 0:ms.length)>0||((xs=(hs=t.demographicFilters)==null?void 0:hs.generation)==null?void 0:xs.length)>0||((gs=(us=t.demographicFilters)==null?void 0:us.income)==null?void 0:gs.length)>0||t.selectedStates.length>0)&&e.jsxs("button",{onClick:()=>{T(s=>({...s,selectedPersonas:[],massTargeting:!1,demographicFilters:{race:[],generation:[],income:[]},selectedStates:[]})),console.log("ðŸ—‘ï¸ Step 2: All audience selections cleared")},className:"px-4 py-2 bg-red-900/20 hover:bg-red-900/40 border border-red-700 hover:border-red-600 rounded-lg text-sm font-medium text-red-400 hover:text-red-300 transition-colors flex items-center gap-2",title:"Clear all audience selections and filters",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Clear All"]})]})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Choose the personas that matter. We will pull the right Astro audience segments and scale from there."})]}),be&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Loading personas..."})]})}),!be&&M.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-400 mb-2",children:"âš ï¸ Failed to load personas"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Please refresh the page or contact support."})]}),!be&&M.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6 bg-[#0f0f0f] border border-gray-800 rounded-xl p-6",children:[e.jsxs("div",{className:"mb-6 p-4 bg-[#1a1a1a] border border-gray-700 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-3",children:"Audience Targeting Filters (Optional)"}),e.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Narrow your audience by demographics and location. This will reduce the reach proportionally."}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-2",children:"Race"}),e.jsxs("button",{onClick:()=>re(q==="race"?null:"race"),className:"w-full bg-[#0f0f0f] border border-gray-700 text-white text-sm rounded-lg px-3 py-2 text-left flex items-center justify-between hover:border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("span",{className:"truncate",children:((fs=(ps=t.demographicFilters)==null?void 0:ps.race)==null?void 0:fs.length)>0?`${t.demographicFilters.race.length} selected`:"Select race..."}),e.jsx("svg",{className:"w-4 h-4 ml-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),q==="race"&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-[#0f0f0f] border border-gray-700 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:["Malay","Chinese","Indian"].map(s=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 hover:bg-gray-800 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.demographicFilters.race.includes(s),onChange:a=>{const r=a.target.checked?[...t.demographicFilters.race,s]:t.demographicFilters.race.filter(o=>o!==s);y({demographicFilters:{...t.demographicFilters,race:r}})},className:"w-4 h-4 text-cyan-500 border-gray-600 rounded focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-white flex-1",children:s}),e.jsx("span",{className:"text-xs text-gray-400",children:s==="Malay"?"69.7%":s==="Chinese"?"22.8%":"6.7%"})]},s))})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-2",children:"Generation"}),e.jsxs("button",{onClick:()=>re(q==="generation"?null:"generation"),className:"w-full bg-[#0f0f0f] border border-gray-700 text-white text-sm rounded-lg px-3 py-2 text-left flex items-center justify-between hover:border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("span",{className:"truncate",children:((vs=(bs=t.demographicFilters)==null?void 0:bs.generation)==null?void 0:vs.length)>0?`${t.demographicFilters.generation.length} selected`:"Select generation..."}),e.jsx("svg",{className:"w-4 h-4 ml-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),q==="generation"&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-[#0f0f0f] border border-gray-700 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:[{value:"Gen Z",percent:"25.4%"},{value:"Millennials",percent:"30.3%"},{value:"Gen X",percent:"24.5%"},{value:"Boomers",percent:"19.8%"}].map(s=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 hover:bg-gray-800 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.demographicFilters.generation.includes(s.value),onChange:a=>{const r=a.target.checked?[...t.demographicFilters.generation,s.value]:t.demographicFilters.generation.filter(o=>o!==s.value);y({demographicFilters:{...t.demographicFilters,generation:r}})},className:"w-4 h-4 text-cyan-500 border-gray-600 rounded focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-white flex-1",children:s.value}),e.jsx("span",{className:"text-xs text-gray-400",children:s.percent})]},s.value))})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-2",children:"Income"}),e.jsxs("button",{onClick:()=>re(q==="income"?null:"income"),className:"w-full bg-[#0f0f0f] border border-gray-700 text-white text-sm rounded-lg px-3 py-2 text-left flex items-center justify-between hover:border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("span",{className:"truncate",children:((js=(ys=t.demographicFilters)==null?void 0:ys.income)==null?void 0:js.length)>0?`${t.demographicFilters.income.length} selected`:"Select income..."}),e.jsx("svg",{className:"w-4 h-4 ml-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),q==="income"&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-[#0f0f0f] border border-gray-700 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:[{value:"B40",percent:"40%"},{value:"M40",percent:"40%"},{value:"T20",percent:"20%"}].map(s=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 hover:bg-gray-800 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.demographicFilters.income.includes(s.value),onChange:a=>{const r=a.target.checked?[...t.demographicFilters.income,s.value]:t.demographicFilters.income.filter(o=>o!==s.value);y({demographicFilters:{...t.demographicFilters,income:r}})},className:"w-4 h-4 text-cyan-500 border-gray-600 rounded focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-white flex-1",children:s.value}),e.jsx("span",{className:"text-xs text-gray-400",children:s.percent})]},s.value))})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-2",children:"Geography"}),e.jsxs("button",{onClick:()=>re(q==="geography"?null:"geography"),className:"w-full bg-[#0f0f0f] border border-gray-700 text-white text-sm rounded-lg px-3 py-2 text-left flex items-center justify-between hover:border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("span",{className:"truncate",children:t.selectedStates.length>0?`${t.selectedStates.length} states`:"All states (Nationwide)"}),e.jsx("svg",{className:"w-4 h-4 ml-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),q==="geography"&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-[#0f0f0f] border border-gray-700 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-[#0f0f0f] border-b border-gray-700 px-3 py-2 flex gap-2",children:[e.jsx("button",{onClick:()=>y({selectedStates:[...Y]}),className:"text-xs text-cyan-400 hover:text-cyan-300 font-semibold",children:"Select All"}),e.jsx("span",{className:"text-xs text-gray-600",children:"|"}),e.jsx("button",{onClick:()=>y({selectedStates:[]}),className:"text-xs text-cyan-400 hover:text-cyan-300 font-semibold",children:"Clear"})]}),[{value:"Federal Territory of Kuala Lumpur",label:"Kuala Lumpur"},{value:"Selangor",label:"Selangor"},{value:"Johor",label:"Johor"},{value:"Perak",label:"Perak"},{value:"Sabah",label:"Sabah"},{value:"Sarawak",label:"Sarawak"},{value:"Penang",label:"Penang"},{value:"Kedah",label:"Kedah"},{value:"Negeri Sembilan",label:"Negeri Sembilan"},{value:"Malacca",label:"Malacca"},{value:"Kelantan",label:"Kelantan"},{value:"Terengganu",label:"Terengganu"},{value:"Pahang",label:"Pahang"},{value:"Putrajaya",label:"Putrajaya"},{value:"Perlis",label:"Perlis"},{value:"Labuan Federal Territory",label:"Labuan"}].map(s=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 hover:bg-gray-800 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.selectedStates.includes(s.value),onChange:a=>{const r=a.target.checked?[...t.selectedStates,s.value]:t.selectedStates.filter(o=>o!==s.value);y({selectedStates:r})},className:"w-4 h-4 text-cyan-500 border-gray-600 rounded focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-white",children:s.label})]},s.value))]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-white mb-2",children:["Personas (KULT Audience Playbook) ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Select personas manually or use AI recommendations from the right panel â†’"}),e.jsx("div",{className:"mb-4 p-4 bg-[#1a1a1a] border border-gray-700 rounded-lg",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.massTargeting,onChange:s=>{const a=s.target.checked;y({massTargeting:a,selectedPersonas:a?M.map(r=>r.name):[]})},className:"w-5 h-5 rounded border-gray-600 bg-gray-800 text-cyan-500 focus:ring-cyan-500 focus:ring-offset-gray-900"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-semibold text-white",children:"Mass Targeting"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Target entire Malaysia population (16.15M) - use filters to refine"})]})]})}),t.massTargeting&&e.jsx("div",{className:"mb-4 p-4 bg-gradient-to-br from-cyan-900/20 to-blue-900/20 border border-cyan-700/50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-cyan-400 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-white mb-1",children:"Mass Targeting Active"}),e.jsx("p",{className:"text-xs text-gray-300",children:"Targeting the entire Malaysia population (16.15M base). Use demographic and geography filters above to refine your audience."})]})]})}),!t.massTargeting&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:J,onChange:s=>fe(s.target.value),placeholder:"Search personas by name or category...",className:"w-full px-4 py-2 pl-10 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent"}),e.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),J&&e.jsx("button",{onClick:()=>fe(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-300",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),!t.massTargeting&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto p-2",children:[M.filter(s=>{if(!J)return!0;const a=J.toLowerCase();return s.name.toLowerCase().includes(a)||s.category.toLowerCase().includes(a)}).map(s=>e.jsxs("button",{onClick:()=>rs(s.name),className:`p-4 rounded-lg border text-left transition-all ${t.selectedPersonas.includes(s.name)?"bg-cyan-900/30 border-cyan-500 shadow-lg shadow-cyan-500/20":"bg-[#1a1a1a] border-gray-700 hover:border-gray-600"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("div",{className:`text-xs font-semibold ${t.selectedPersonas.includes(s.name)?"text-cyan-400":"text-gray-500"}`,children:s.category}),t.selectedPersonas.includes(s.name)&&e.jsx("div",{className:"w-5 h-5 bg-cyan-500 rounded-full flex items-center justify-center text-white",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]}),e.jsx("div",{className:"text-sm font-semibold text-white mb-1",children:s.name}),e.jsxs("div",{className:"text-xs text-gray-400",children:[pe(s.size)," users"]})]},s.name)),M.filter(s=>{if(!J)return!0;const a=J.toLowerCase();return s.name.toLowerCase().includes(a)||s.category.toLowerCase().includes(a)}).length===0&&e.jsxs("div",{className:"col-span-full text-center py-8 text-gray-500",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsxs("p",{children:['No personas found matching "',J,'"']}),e.jsx("button",{onClick:()=>fe(""),className:"mt-2 text-cyan-400 hover:text-cyan-300 text-sm underline",children:"Clear search"})]})]}),!t.massTargeting&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Start with 3â€“5 personas max. The planner can always scale up later."}),C.personas&&e.jsxs("p",{className:"text-xs text-red-400 mt-1 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),C.personas]})]}),!t.massTargeting&&t.selectedPersonas.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:t.selectedPersonas.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-cyan-500 text-white rounded-full text-sm",children:[s,e.jsx("button",{onClick:()=>rs(s),className:"hover:text-gray-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},s))}),(()=>{const s=Ae();return s?e.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-br from-purple-900/20 to-cyan-900/20 border border-purple-700/50 rounded-lg",children:[e.jsxs("h4",{className:"text-sm font-semibold text-purple-300 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Audience Overlap Analysis"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:pe(s.totalRaw)}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Total Raw Audience"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[s.overlapPercent,"%"]}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Est. Overlap"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:pe(s.uniqueReach)}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Unique Reach"})]})]}),e.jsx("p",{className:"text-xs text-purple-300 mt-3 italic",children:"Note: Overlap is estimated based on persona categories. Personas in the same category have ~60% overlap, different categories ~25%."})]}):null})(),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-white mb-2",children:["Target Language(s) ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Select the language(s) for your campaign creative and messaging"}),e.jsx("div",{className:"space-y-2 bg-[#1a1a1a] border border-gray-700 rounded-lg p-4",children:["Bahasa Malaysia","English","Chinese"].map(s=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer hover:bg-gray-800/50 p-2 rounded transition-colors",children:[e.jsx("input",{type:"checkbox",checked:t.targetLanguages.includes(s),onChange:a=>{const r=a.target.checked?[...t.targetLanguages,s]:t.targetLanguages.filter(o=>o!==s);y({targetLanguages:r})},className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-cyan-500 focus:ring-cyan-500 focus:ring-offset-gray-900"}),e.jsx("span",{className:"text-sm text-white",children:s})]},s))}),e.jsx("div",{className:"mt-2 p-3 bg-yellow-900/20 border border-yellow-700/50 rounded-lg",children:e.jsxs("p",{className:"text-xs text-yellow-400 flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{children:[e.jsx("strong",{children:"Note:"})," Creative assets must be provided in the selected language(s). Ensure your content is culturally appropriate and professionally translated."]})]})}),C.targetLanguages&&e.jsxs("p",{className:"text-xs text-red-400 mt-2 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),C.targetLanguages]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-white",children:"Saved Audience Groups"}),e.jsxs("div",{className:"flex gap-2",children:[t.selectedPersonas.length>0&&e.jsx("button",{onClick:()=>{y({selectedPersonas:[],demographicFilters:{race:[],generation:[],income:[]}})},className:"px-4 py-2 bg-red-900/30 border border-red-700 text-red-300 rounded-lg hover:bg-red-900/50 transition-colors text-sm font-semibold",children:"Clear Selection"}),e.jsxs("button",{onClick:()=>{ue(),X(!0)},className:"px-4 py-2 bg-gradient-to-r from-cyan-500 to-purple-600 hover:from-cyan-600 hover:to-purple-700 text-white rounded-lg text-sm font-semibold transition-all flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Load Saved Audience"]}),e.jsx("button",{onClick:()=>{le(""),ye(null),ve(!0)},disabled:t.selectedPersonas.length===0,className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${t.selectedPersonas.length>0?"bg-gradient-to-r from-green-500 to-emerald-600 text-white hover:from-green-600 hover:to-emerald-700":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:"+ Save Current Selection"})]})]}),t.audienceGroups.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:t.audienceGroups.map((s,a)=>e.jsxs("div",{className:"p-4 bg-[#1a1a1a] border border-gray-700 rounded-lg hover:border-cyan-500 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"text-sm font-semibold text-white mb-1",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[s.personas.length," persona",s.personas.length!==1?"s":"",s.demographicFilters.race.length+s.demographicFilters.generation.length+s.demographicFilters.income.length>0&&` â€¢ ${s.demographicFilters.race.length+s.demographicFilters.generation.length+s.demographicFilters.income.length} filters`,s.selectedStates&&s.selectedStates.length>0&&` â€¢ ${s.selectedStates.length} states`]}),s.uniqueReach>0&&e.jsxs("p",{className:"text-xs font-semibold text-cyan-400 mt-1",children:["Unique Reach: ",(s.uniqueReach/1e6).toFixed(2),"M"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>it(s),className:"p-1 text-cyan-400 hover:text-cyan-300 transition-colors",title:"Load this group",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),e.jsx("button",{onClick:()=>ct(a),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"Delete this group",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[s.personas.slice(0,3).map(r=>e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900/30 text-cyan-300 text-xs rounded",children:r},r)),s.personas.length>3&&e.jsxs("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-400 text-xs rounded",children:["+",s.personas.length-3," more"]})]})]},s.id))}):e.jsxs("div",{className:"text-center py-6 px-4 bg-[#1a1a1a] border border-gray-700 border-dashed rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"No saved audience groups yet"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Select personas and click "Save Current Selection" above'})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Any specific intent or behaviours? (optional)"}),e.jsx("textarea",{value:t.audienceIntent,onChange:s=>y({audienceIntent:s.target.value}),placeholder:'E.g. "Test drive intenders", "Price-sensitive young families", "K-Drama binge watchers"',rows:3,className:"w-full px-4 py-3 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyan-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This gives the AI a chance to refine the persona mix and channel weightage."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Anyone we should exclude? (optional)"}),e.jsx("input",{type:"text",value:t.audienceExclusions,onChange:s=>y({audienceExclusions:s.target.value}),placeholder:"E.g. existing customers, kids under 18, other regions",className:"w-full px-4 py-3 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyan-500"})]})]}),Ss&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#0f0f0f] border border-gray-700 rounded-xl p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:ie!==null?"Edit Audience Group":"Save Audience Group"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Group Name"}),e.jsx("input",{type:"text",value:Q,onChange:s=>le(s.target.value),placeholder:"E.g., Premium Auto Buyers, Young Families",className:"w-full px-4 py-3 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyan-500",autoFocus:!0})]}),e.jsxs("div",{className:"p-3 bg-[#1a1a1a] border border-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Selected Personas:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.selectedPersonas.map(s=>e.jsx("span",{className:"px-2 py-1 bg-cyan-900/30 text-cyan-300 text-xs rounded",children:s},s))}),t.demographicFilters.race.length+t.demographicFilters.generation.length+t.demographicFilters.income.length>0&&e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-700",children:e.jsxs("p",{className:"text-xs text-gray-400",children:["Demographic Filters: ",t.demographicFilters.race.join(", "),t.demographicFilters.race.length>0&&", ",t.demographicFilters.generation.join(", "),t.demographicFilters.generation.length>0&&", ",t.demographicFilters.income.join(", ")]})}),t.selectedStates.length>0&&e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-700",children:e.jsxs("p",{className:"text-xs text-gray-400",children:["States: ",t.selectedStates.length===Y.length?"All (Nationwide)":`${t.selectedStates.slice(0,3).join(", ")}${t.selectedStates.length>3?` +${t.selectedStates.length-3} more`:""}`]})}),(()=>{const s=Ae();return s&&s.uniqueReach>0&&e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-700",children:e.jsxs("p",{className:"text-xs font-semibold text-cyan-400",children:["Estimated Unique Reach: ",(s.uniqueReach/1e6).toFixed(2),"M"]})})})()]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{ve(!1),le(""),ye(null)},className:"flex-1 px-4 py-3 bg-[#1a1a1a] border border-gray-700 text-white rounded-lg hover:bg-[#222] transition-colors",children:"Cancel"}),e.jsx("button",{onClick:lt,className:"flex-1 px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all",children:"Save Group"})]})]})]})}),Ee&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#0f0f0f] border border-gray-700 rounded-xl p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Load Saved Audience"}),e.jsx("button",{onClick:()=>X(!1),className:"p-1 text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),We?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"text-gray-400",children:"Loading saved audiences..."})}):ce.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("h4",{className:"text-white font-semibold mb-2",children:"No Saved Audiences Yet"}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Create audience groups in the AI Wizard or save your current selection first."}),e.jsx("button",{onClick:()=>X(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Close"})]}):e.jsx("div",{className:"space-y-3",children:ce.map(s=>e.jsxs("div",{className:"p-4 bg-[#1a1a1a] border border-gray-700 rounded-lg hover:border-cyan-500 transition-all cursor-pointer",onClick:()=>loadSavedAudienceGroup(s),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-white font-semibold mb-1",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[s.personas.length," personas â€¢ ",((s.uniqueReach||s.unduplicated||0)/1e6).toFixed(2),"M reach"]}),(s.industry||s.objective)&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.industry&&e.jsx("span",{children:s.industry}),s.industry&&s.objective&&e.jsx("span",{children:" â€¢ "}),s.objective&&e.jsx("span",{children:s.objective})]})]}),e.jsxs("button",{onClick:a=>{a.stopPropagation(),loadSavedAudienceGroup(s)},className:"p-2 bg-gradient-to-r from-cyan-500 to-purple-600 hover:from-cyan-600 hover:to-purple-700 text-white rounded-lg transition-all flex items-center gap-1 text-sm font-semibold",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Load"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.personas.slice(0,5).map((a,r)=>e.jsx("span",{className:"px-2 py-1 bg-cyan-900/20 border border-cyan-700/50 rounded text-xs text-cyan-300",children:a},r)),s.personas.length>5&&e.jsxs("span",{className:"px-2 py-1 bg-gray-800 border border-gray-700 rounded text-xs text-gray-400",children:["+",s.personas.length-5," more"]})]})]},s.id))})]})})]})]}),c===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"4. Where should your budget go?"}),(F.length>0||t.selectedSites.length>0)&&e.jsxs("button",{onClick:()=>{H([]),T(s=>({...s,selectedSites:[],optimisedGroups:[]})),console.log("ðŸ—‘ï¸ All budget channels and sites cleared")},className:"px-4 py-2 bg-red-900/20 hover:bg-red-900/40 border border-red-700 hover:border-red-600 rounded-lg text-sm font-medium text-red-400 hover:text-red-300 transition-colors flex items-center gap-2",title:"Clear all budget allocations and site selections",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Clear All"]})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Set your total budget, select sites, then allocate across channels. CPMs are based on your selected formats."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-cyan-900/20 to-purple-900/20 border border-cyan-500/30 rounded-xl p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-cyan-400 mb-2",children:["Total Budget (RM) ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:t.totalBudget?parseInt(t.totalBudget).toLocaleString():"",onChange:s=>{const a=s.target.value.replace(/[^0-9]/g,"");y({totalBudget:a})},placeholder:"120,000",className:`w-full px-4 py-3 bg-[#1a1a1a] border ${C.totalBudget?"border-red-500":"border-gray-700"} rounded-lg text-white text-lg font-bold placeholder-gray-500 focus:outline-none focus:border-cyan-500`}),C.totalBudget&&e.jsxs("p",{className:"text-xs text-red-400 mt-1 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),C.totalBudget]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Allocated Budget"}),e.jsx("div",{className:"px-4 py-3 bg-[#1a1a1a] border border-gray-700 rounded-lg",children:e.jsxs("span",{className:"text-lg font-bold text-white",children:["RM ",F.reduce((s,a)=>s+a.budget,0).toLocaleString()]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Remaining Balance"}),e.jsx("div",{className:`px-4 py-3 border rounded-lg ${se()<0?"bg-red-900/30 border-red-500":se()===0?"bg-green-900/30 border-green-500":"bg-[#1a1a1a] border-gray-700"}`,children:e.jsxs("span",{className:`text-lg font-bold ${se()<0?"text-red-400":se()===0?"text-green-400":"text-white"}`,children:["RM ",se().toLocaleString()]})}),se()<0&&e.jsxs("p",{className:"text-xs text-red-400 mt-1 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Over budget!"]}),C.budgetAllocation&&e.jsxs("p",{className:"text-xs text-red-400 mt-2 flex items-center gap-1 bg-red-900/20 border border-red-500/30 rounded p-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),C.budgetAllocation]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Budget Allocation Progress"}),e.jsxs("span",{className:"text-xs font-semibold text-white",children:[ge().toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-800 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${ge()>100?"bg-red-500":ge()===100?"bg-green-500":"bg-gradient-to-r from-cyan-500 to-purple-600"}`,style:{width:`${Math.min(ge(),100)}%`}})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-2 mt-8",children:"Where should your ads run?"}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"We've filtered recommended sites based on your audience and industry. You can pin must-have sites or let the planner optimise within a group."}),e.jsx("div",{className:"space-y-4",children:Object.entries(et()).map(([s,a])=>{const r=Rs[s]===!0,o=a.filter(l=>t.selectedSites.includes(l.id)).length,n=t.optimisedGroups.includes(s);return e.jsxs("div",{className:"bg-[#0f0f0f] border border-gray-800 rounded-xl overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-gray-900/50 transition-colors",onClick:()=>ns(s),children:e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),ns(s)},className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:`w-5 h-5 transition-transform ${r?"rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),e.jsx("h3",{className:"text-lg font-bold text-white",children:s}),e.jsxs("span",{className:"text-sm text-gray-400",children:["(",a.length," sites available)"]}),(o>0||n)&&e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${n?"bg-purple-900/30 text-purple-400 border border-purple-700":"bg-cyan-900/30 text-cyan-400 border border-cyan-700"}`,children:n?"âœ“ Optimised":`${o} selected`})]})}),r&&e.jsxs("div",{className:"px-6 pb-6 pt-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-gray-300 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:a.every(l=>t.selectedSites.includes(l.id)),onChange:()=>rt(s,a),disabled:t.optimisedGroups.includes(s),className:"w-4 h-4 accent-cyan-500"}),e.jsx("span",{children:"Select All"})]}),e.jsxs("label",{className:`flex items-center gap-2 text-sm transition-colors ${(s==="OTT"?o<3:o<5)&&!t.optimisedGroups.includes(s)?"text-gray-600 cursor-not-allowed":"text-gray-400 cursor-pointer hover:text-gray-300"}`,children:[e.jsx("input",{type:"checkbox",checked:t.optimisedGroups.includes(s),onChange:()=>at(s),disabled:(s==="OTT"?o<3:o<5)&&!t.optimisedGroups.includes(s),className:"w-4 h-4 accent-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",title:s==="OTT"?o<3?"Select all 3 OTT sites to enable optimization":"Let the system optimize across selected sites":o<5?"Select at least 5 sites to enable optimization":"Let the system optimize across selected sites"}),e.jsx("span",{children:"Optimise across this group automatically"}),(s==="OTT"&&o<3||s!=="OTT"&&o<5)&&!t.optimisedGroups.includes(s)&&e.jsx("span",{className:"text-xs text-gray-600",children:s==="OTT"?"(need all 3 OTT sites)":"(need 5+ sites)"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.map(l=>{const i=t.selectedSites.includes(l.id),b=t.optimisedGroups.includes(s),v=b&&i;return e.jsxs("button",{onClick:()=>tt(l.id),disabled:b,className:`p-4 rounded-lg border text-left transition-all ${v?"bg-purple-900/20 border-purple-700":i?"bg-cyan-900/30 border-cyan-500 shadow-lg shadow-cyan-500/20":"bg-[#1a1a1a] border-gray-700 hover:border-gray-600"}`,title:l.description,children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("div",{className:"text-cyan-400",children:e.jsx(ks,{type:l.icon})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-white mb-1",children:l.name}),e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:l.category}),e.jsxs("div",{className:"text-xs text-cyan-400",children:[l.traffic," available impressions"]})]}),i&&e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-white flex-shrink-0 ${b?"bg-purple-500":"bg-cyan-500"}`,children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:l.tags.map(j=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-800 text-gray-400 text-xs rounded",children:j},j))})]},l.id)})})]})]},s)})}),C.sites&&e.jsxs("p",{className:"text-sm text-red-400 flex items-center gap-1 mt-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),C.sites]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Channel Budget Allocation"}),F.length===0?e.jsxs("div",{className:"bg-[#0f0f0f] border-2 border-dashed border-gray-700 rounded-xl p-12 text-center",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h4",{className:"text-lg font-semibold text-white mb-2",children:"No channels added yet"}),e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:['Click "Add to Plan" on AI recommendations â†’',e.jsx("br",{}),"or manually add channels below"]})]}):e.jsx("div",{className:"space-y-4",children:F.map(s=>e.jsxs("div",{className:"bg-[#0f0f0f] border border-gray-800 rounded-xl p-6 hover:border-gray-700 transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s.color}`}),e.jsx("h4",{className:"text-lg font-bold text-white",children:s.name}),s.hasLoading&&e.jsx("span",{className:"px-2 py-0.5 bg-amber-900/30 border border-amber-500/50 rounded text-xs font-semibold text-amber-400",children:"+100% Loading"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:[(s.budget/(parseFloat(t.totalBudget)||1)*100).toFixed(1),"% of total"]}),e.jsx("button",{onClick:()=>H(a=>a.filter(r=>r.id!==s.id)),className:"text-gray-500 hover:text-red-400 transition-colors",title:"Remove channel",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-400 mb-2",children:"Budget (RM)"}),e.jsx("input",{type:"text",value:s.budget?parseInt(s.budget).toLocaleString():"",onChange:a=>{const r=a.target.value.replace(/[^0-9]/g,"");nt(s.id,r)},className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-400 mb-2",children:"CPM (RM)"}),e.jsx("div",{className:"px-3 py-2 bg-[#0a0a0a] border border-gray-800 rounded-lg",children:e.jsxs("span",{className:"text-white font-semibold",children:[s.cpm,s.hasLoading&&e.jsx("span",{className:"text-xs text-amber-400 ml-2",children:"(100% Loading)"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-400 mb-2",children:"Est. Impressions"}),e.jsx("div",{className:"px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg",children:e.jsxs("span",{className:"text-white font-semibold",children:[(s.impressions/1e6).toFixed(2),"M"]})})]})]})]},s.id))})]}),(()=>{const s=F.reduce((p,m)=>p+(m.impressions||0),0),r=Object.values(K).flat().filter(p=>t.selectedSites.includes(p.id)),o=r.reduce((p,m)=>{const u=m.traffic||"0",x=parseFloat(u.replace("M",""))*1e6||parseFloat(u.replace("K",""))*1e3||parseFloat(u)||0;return p+x},0),n=t.startDate?new Date(t.startDate):null,l=t.endDate?new Date(t.endDate):null;let i=1;if(n&&l&&l>=n){const p=Math.abs(l-n),m=Math.ceil(p/(1e3*60*60*24));i=Math.max(1,Math.ceil(m/30))}const b=o*i,v=s>b&&F.length>0&&r.length>0,j=b>0?(s/b*100).toFixed(1):0;return v?e.jsx("div",{className:"bg-red-900/20 border-2 border-red-600 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-red-400 mb-2",children:"Insufficient Inventory Available"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-300",children:[e.jsx("p",{children:e.jsxs("strong",{className:"text-red-400",children:["Your booked impressions exceed available inventory by ",(j-100).toFixed(1),"%"]})}),e.jsxs("div",{className:"bg-black/40 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Booked Impressions:"}),e.jsxs("span",{className:"font-bold text-red-400",children:[(s/1e6).toFixed(2),"M"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["Available Impressions (",i," month",i>1?"s":"","):"]}),e.jsxs("span",{className:"font-bold text-cyan-400",children:[(b/1e6).toFixed(2),"M"]})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-gray-700",children:[e.jsx("span",{children:"Utilization:"}),e.jsxs("span",{className:"font-bold text-red-400",children:[j,"%"]})]})]}),e.jsxs("div",{className:"bg-amber-900/20 border border-amber-600 rounded-lg p-4 mt-4",children:[e.jsx("p",{className:"font-semibold text-amber-400 mb-2",children:"ðŸ’¡ Recommendations:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-300",children:[i===1&&e.jsxs("li",{children:[e.jsx("strong",{children:"You have reached the maximum capacity for available impressions."})," Please select more sites (IPs) to fulfill the impressions required. Currently using ",r.length," site",r.length!==1?"s":"",". Add more OTT/Web sites to increase available inventory."]}),i>1&&e.jsxs("li",{children:[e.jsx("strong",{children:"Extend campaign period"})," - Current: ",i," month",i>1?"s":"",". Longer campaigns increase available inventory."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Reduce budget allocation"})," - Lower the budget for each channel to match available inventory."]}),e.jsxs("li",{children:[e.jsx("strong",{children:'Enable "Optimize"'})," - Let the system optimize across sites to maximize efficiency and remove 100% loading."]})]})]})]})]})]})}):null})(),e.jsxs("div",{className:"bg-[#0f0f0f] border border-gray-800 rounded-xl p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-3",children:"Budget Flexibility (optional)"}),e.jsx("div",{className:"space-y-2",children:[{value:"fixed",label:"Fixed â€“ cannot exceed"},{value:"stretch_10",label:"Can stretch by ~10%"},{value:"ballpark",label:"Rough ballpark â€“ open to recommendations"}].map(s=>e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${t.budgetFlexibility===s.value?"bg-cyan-900/30 border-cyan-500":"bg-[#1a1a1a] border-gray-700 hover:border-gray-600"}`,children:[e.jsx("input",{type:"radio",name:"budgetFlexibility",value:s.value,checked:t.budgetFlexibility===s.value,onChange:a=>y({budgetFlexibility:a.target.value}),className:"w-4 h-4 accent-cyan-500"}),e.jsx("span",{className:"text-sm text-white",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-3",children:"Buying Preference (optional)"}),e.jsxs("select",{value:t.buyingPreference,onChange:s=>y({buyingPreference:s.target.value}),className:"w-full px-4 py-3 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"no_preference",children:"No preference"}),e.jsx("option",{value:"direct_only",children:"Direct only"}),e.jsx("option",{value:"mix",children:"Mix of Direct & Programmatic"}),e.jsx("option",{value:"programmatic_first",children:"Programmatic-first"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Choose how you prefer to buy media inventory."})]})]})]}),c===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"3. Which formats do you want to use?"}),t.selectedFormats.length>0&&e.jsxs("button",{onClick:()=>{T(s=>({...s,selectedFormats:[]}))},className:"px-4 py-2 bg-red-900/20 hover:bg-red-900/40 border border-red-700 hover:border-red-600 rounded-lg text-sm font-medium text-red-400 hover:text-red-300 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Clear All Formats"]})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Select formats first - this will determine CPMs for budget planning. Click any format card to add it to your plan."})]}),t.selectedFormats.length>0&&e.jsxs("div",{className:"bg-cyan-900/20 border border-cyan-700 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-cyan-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Available Inventory for Selected Formats"})]}),(()=>{const a=Fe().formats.filter(o=>o.availableInventory>0).length,r=t.selectedFormats.length;return e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${a<r?"bg-yellow-900/30 text-yellow-400":"bg-gray-800 text-gray-400"}`,children:[r," format",r!==1?"s":""," selected",a<r&&e.jsxs("span",{className:"ml-1",children:["(",a," with inventory)"]})]})})()]}),(()=>{const s=Fe(),a=(t.targetLanguages||[]).map(p=>p.toLowerCase()),o=["bahasa malaysia","english","chinese"].every(p=>a.some(m=>m.includes(p.split(" ")[0]))),n=a.length>0&&!o;if(s.availableInventory===0)return e.jsxs("div",{className:"text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{children:"No inventory data available for selected formats."})]}),n&&e.jsx("p",{className:"mt-2 ml-6",children:"Try selecting formats with broader language support or changing your language selection."})]});const l=s.availableInventory>=1e6?`${(s.availableInventory/1e6).toFixed(1)}M`:s.availableInventory>=1e3?`${Math.round(s.availableInventory/1e3)}K`:s.availableInventory.toString();let i="High",b="text-green-400",v=e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),j="Excellent inventory availability for optimal campaign delivery.";return s.availableInventory<5e5?(i="Very Low",b="text-red-400",v=e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),j="Limited inventory. Consider selecting additional formats with higher inventory for better reach."):s.availableInventory<5e6?(i="Low",b="text-yellow-400",v=e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),j="Moderate inventory. Adding more formats may improve campaign flexibility."):s.availableInventory<2e7&&(i="Medium",b="text-cyan-400",v=e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),j="Good inventory availability for your selected formats."),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Available Inventory:"}),e.jsx("span",{className:`text-2xl font-bold ${b}`,children:l})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[e.jsx("span",{children:"Inventory Level:"}),e.jsxs("div",{className:`flex items-center gap-1 ${b} font-semibold`,children:[v,e.jsx("span",{children:i})]})]}),e.jsxs("div",{className:"space-y-2 mt-2 pt-2 border-t border-gray-700",children:[o?e.jsxs("div",{className:"flex items-center gap-2 text-xs text-cyan-400",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"Language: All Languages (Mass Targeting)"})]}):n?e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})}),e.jsxs("span",{children:["Language: ",t.targetLanguages.join(", ")]})]}):null,s.personaRatio&&s.personaRatio<1&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsxs("span",{children:["Persona targeting: ",(s.personaRatio*100).toFixed(1),"% of base audience"]})]})]}),e.jsxs("div",{className:"mt-3 p-3 bg-gray-900/50 rounded-lg space-y-2",children:[e.jsx("p",{className:`text-sm ${b}`,children:j}),(()=>{const p=s.formats.filter(u=>u.availableInventory>0).length,m=t.selectedFormats.length-p;return e.jsxs(e.Fragment,{children:[m>0&&e.jsxs("p",{className:"text-xs text-yellow-400 flex items-start gap-2",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsxs("span",{children:[e.jsx("strong",{children:"Note:"})," ",m," selected format",m!==1?"s have":" has"," no inventory data (e.g., Social formats). Consider selecting other formats with available inventory."]})]}),t.selectedFormats.length<5&&m===0&&e.jsxs("p",{className:"text-xs text-gray-400 flex items-start gap-2",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0 mt-0.5 text-cyan-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{children:[e.jsx("strong",{children:"Tip:"})," Select more ad formats to increase available inventory. Total platform capacity is ~75M impressions/month for mass targeting."]})]})]})})()]})]})})()]}),Es?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Loading..."})]})}):e.jsx("div",{className:"space-y-4",children:Object.entries(ee).map(([s,a])=>{const r=Vs[s],o=a.filter(n=>t.selectedFormats.includes(n.id)).length;return e.jsxs("div",{className:"bg-[#0f0f0f] border border-gray-800 rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>Hs(s),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform ${r?"":"rotate-90"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:s}),e.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:[s==="High Impact"&&"For launches, takeovers and big brand moments.",s==="Video"&&"Use these when sight, sound, and story matter.",s==="Display & Native"&&"Bread-and-butter reach and supporting inventory.",s==="Lead & Performance"&&"Formats that collect data, leads, or drive measurable actions.",s==="Interactive"&&"Use selectively to create engagement spikes, not as the only format.",s==="Social"&&"Optimized for social media platforms like Facebook, Instagram, and TikTok."]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[o>0&&e.jsxs("span",{className:"px-2 py-1 bg-cyan-900/30 border border-cyan-700 text-cyan-400 text-xs font-semibold rounded",children:[o," selected"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[a.length," format",a.length!==1?"s":""]})]})]}),!r&&e.jsx("div",{className:"px-6 pb-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.map(n=>{const l=t.selectedFormats.includes(n.id);return(n.name==="Masthead"||n.name==="Leaderboard"||n.name==="In-stream Video"||n.name==="MREC")&&console.log(`ðŸ” ${n.name} check:`,{formatId:n.id,formatIdType:typeof n.id,selectedFormats:t.selectedFormats,selectedFormatsLength:t.selectedFormats.length,selectedFormatsTypes:t.selectedFormats.map(i=>typeof i),includes:t.selectedFormats.includes(n.id),isSelected:l,loadedCampaignExists:!!L,urlParamId:R}),e.jsxs("button",{onClick:()=>st(n.id),className:`p-4 rounded-lg border text-left transition-all relative ${l?"bg-cyan-900/30 border-cyan-500 shadow-lg shadow-cyan-500/20":"bg-[#1a1a1a] border-gray-700 hover:border-gray-600"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-white mb-1",children:n.name}),e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:n.description}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"text-cyan-400",children:"Best for:"})," ",n.bestFor]}),(()=>{const i=n.name.toLowerCase(),b=(n.type||"").toLowerCase();let v=i,j=!1,p=[];i.includes("instream")||i.includes("in-stream")?v="pre/midroll":i.includes("pre-roll")?v="preroll":i.includes("mid-roll")?v="midroll":i.includes("image social")?v="social static ad":i.includes("video social")?v="social video ad":i.includes("skinner")||i.includes("wallpaper")?v="masthead":i.includes("takeover")?v="interstitial":b.includes("interactive")&&(j=!0,p=["leaderboard","mrec","masthead","interstitial","catfish","in article"]);let m=null,u=0,x=0;j||(m=ne[v]);const k=(t.targetLanguages||[]).map(w=>w.toLowerCase());if(j?p.forEach(w=>{const f=ne[w];f&&(k.length>0?f.byLanguage.forEach(A=>{const h=A.language.toLowerCase();k.some(N=>h.includes(N)||h.includes("multi"))&&(u+=A.totalRequests/12,x+=A.totalImpressions/12)}):(u+=f.avgMonthlyRequests,x+=f.avgMonthlyImpressions))}):m&&(k.length>0?m.byLanguage.forEach(w=>{const f=w.language.toLowerCase();k.some(A=>f.includes(A)||f.includes("multi"))&&(u+=w.totalRequests/12,x+=w.totalImpressions/12)}):(u=m.avgMonthlyRequests,x=m.avgMonthlyImpressions)),(m||j)&&u>0&&x>0){let f=(u-x)*.25;const A=ts();if(f=f*A,f>0){const h=f>=1e6?`${(f/1e6).toFixed(1)}M`:f>=1e3?`${Math.round(f/1e3)}K`:Math.round(f).toString();let N="text-green-400";return f<1e5?N="text-red-400":f<1e6?N="text-yellow-400":f<1e7&&(N="text-cyan-400"),e.jsxs("div",{className:`text-xs mt-1 ${N} flex items-center gap-1`,children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),h," available impressions"]})}}return e.jsxs("div",{className:"text-xs mt-1 text-gray-500 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"No inventory data"]})})()]}),t.selectedFormats.includes(n.id)&&e.jsx("div",{className:"ml-3 w-6 h-6 bg-cyan-500 rounded-full flex items-center justify-center text-white flex-shrink-0",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:n.tags.map(i=>e.jsx("span",{className:"px-2 py-0.5 bg-purple-900/30 text-purple-300 text-xs rounded",children:i},i))})]},n.id)})})})]},s)})}),C.formats&&e.jsxs("p",{className:"text-sm text-red-400 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),C.formats]}),C.formatsWarning&&e.jsxs("p",{className:"text-sm text-yellow-400 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),C.formatsWarning]})]}),c===5&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"5. Review & lock your plan"}),t.status&&e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${t.status==="booked"?"bg-green-900/30 text-green-400 border border-green-700":"bg-gray-800 text-gray-400 border border-gray-700"}`,children:t.status==="booked"?"âœ“ Booked":"Draft"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Here's the draft plan based on your inputs and the KULT playbook. You can still edit any step above before sharing with your client or manager."})]}),e.jsxs("div",{className:"space-y-4 bg-[#0f0f0f] border border-gray-800 rounded-xl p-6",children:[e.jsxs("div",{className:"border-b border-gray-800 pb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-3",children:"Campaign Overview"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Campaign Name:"}),e.jsx("div",{className:"text-white font-semibold",children:t.campaignName||"Untitled Campaign"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Objective:"}),e.jsx("div",{className:"text-white font-semibold",children:t.objective})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Industry:"}),e.jsx("div",{className:"text-white font-semibold",children:t.industry})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Geography:"}),e.jsx("div",{className:"text-white font-semibold",children:t.selectedStates.length===0||t.selectedStates.length===Y.length?"Nationwide (All States)":`${t.selectedStates.length} selected states`})]})]})]}),e.jsxs("div",{className:"border-b border-gray-800 pb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-3",children:"Audience Selection"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.massTargeting?e.jsx("span",{className:"px-3 py-1 bg-purple-900/30 text-purple-300 rounded-full text-sm font-semibold",children:"Mass Targeting"}):t.selectedPersonas.map(s=>e.jsx("span",{className:"px-3 py-1 bg-cyan-900/30 text-cyan-300 rounded-full text-sm",children:s},s))})]}),e.jsxs("div",{className:"border-b border-gray-800 pb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-3",children:"Budget Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Total Budget:"}),e.jsxs("div",{className:"text-white font-semibold text-xl",children:["RM ",parseFloat(t.totalBudget||0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Estimated Impressions:"}),e.jsx("div",{className:"text-cyan-400 font-semibold text-xl",children:pe(t.estimatedImpressions)})]})]})]}),e.jsxs("div",{className:"border-b border-gray-800 pb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-3",children:["Formats Selected (",t.selectedFormats.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:t.selectedFormats.map(s=>{const a=Object.values(ee).flat().find(r=>r.id===s);return a?e.jsx("div",{className:"px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded text-sm text-white",children:a.name},s):null})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-3",children:["Sites (",t.selectedSites.length," selected + ",t.optimisedGroups.length," optimised groups)"]}),e.jsxs("div",{className:"space-y-2",children:[t.selectedSites.map(s=>{const a=Object.keys(K).length>0?K:ae,r=Object.values(a).flat().find(o=>o.id===s);return r?e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded text-sm",children:[e.jsx("span",{className:"text-cyan-400",children:e.jsx(ks,{type:r.icon})}),e.jsx("span",{className:"text-white",children:r.name}),e.jsx("span",{className:"text-gray-500",children:"â€¢"}),e.jsx("span",{className:"text-gray-400 text-xs",children:r.category})]},s):null}),t.optimisedGroups.map(s=>e.jsxs("div",{className:"px-3 py-2 bg-purple-900/20 border border-purple-700 rounded text-sm text-purple-300 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"AI-optimised: ",s]},s))]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-800 text-xs text-gray-500",children:"All numbers shown are estimates and should be validated against latest rate cards and inventory availability."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:Be,className:"px-6 py-3 bg-[#1a1a1a] border border-gray-700 text-white rounded-lg hover:bg-[#222] transition-colors flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"Save as draft"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:mt,className:"px-6 py-3 bg-gradient-to-r from-cyan-500 to-purple-600 text-white font-semibold rounded-lg hover:from-cyan-600 hover:to-purple-700 transition-all shadow-lg hover:shadow-cyan-500/50 flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Export to PDF"]}),e.jsxs("button",{onClick:dt,className:"px-6 py-3 bg-green-900/30 border border-green-700 text-green-300 rounded-lg hover:bg-green-900/50 transition-colors flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export to Excel"]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-gray-800 mt-8",children:[e.jsx("button",{onClick:Qs,disabled:c===1,className:`px-6 py-3 rounded-lg font-semibold transition-all ${c===1?"bg-gray-800 text-gray-600 cursor-not-allowed":"bg-[#1a1a1a] border border-gray-700 text-white hover:bg-[#222]"}`,children:"â† Back"}),e.jsx("button",{onClick:Zs,disabled:c===5&&t.status==="booked",className:`px-8 py-3 font-semibold rounded-lg transition-all shadow-lg flex items-center justify-center gap-2 ${c===5?t.status==="booked"?"bg-gray-800 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-green-500 to-emerald-600 text-white hover:from-green-600 hover:to-emerald-700 hover:shadow-green-500/50":"bg-gradient-to-r from-cyan-500 to-purple-600 text-white hover:from-cyan-600 hover:to-purple-700 hover:shadow-cyan-500/50"}`,title:c===5&&!t.id?"Save as draft first":c===5&&t.status==="booked"?"Already booked":"",children:c===5?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.status==="booked"?"âœ“ Booked":"Book Now"]}):"Next â†’"})]})]}),e.jsx("div",{className:"hidden lg:block w-96 flex-shrink-0",children:e.jsx("div",{className:"sticky top-6 h-[calc(100vh-8rem)]",children:e.jsx(Ns,{currentStep:c===2?"audience":c===3?"formats":c===4?"budget":"overview",recommendations:me,onAddRecommendation:ls,selectedItems:is(),isLoading:De})})}),c!==5&&e.jsxs("button",{onClick:Be,className:"fixed bottom-20 right-4 z-50 bg-gray-800 hover:bg-gray-700 border border-gray-600 text-white px-5 py-3 rounded-full shadow-2xl transition-all flex items-center gap-2",title:"Save your progress as draft",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),e.jsx("span",{className:"font-semibold hidden sm:inline",children:"Save Draft"})]}),c>=2&&e.jsxs("button",{onClick:()=>Ye(!0),className:"lg:hidden fixed bottom-36 right-4 z-50 bg-gradient-to-r from-purple-600 to-cyan-500 text-white px-5 py-3 rounded-full shadow-2xl hover:shadow-cyan-500/50 transition-all flex items-center gap-2 animate-pulse",style:{boxShadow:"0 0 20px rgba(168, 85, 247, 0.5)"},children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z"})}),e.jsx("span",{className:"font-semibold",children:"AI Suggestions"}),me.length>0&&e.jsx("span",{className:"bg-white text-purple-600 px-2 py-0.5 rounded-full text-xs font-bold",children:me.length})]}),Ws&&e.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/90 z-50 overflow-y-auto",children:e.jsxs("div",{className:"min-h-screen p-4 pb-20",children:[e.jsxs("div",{className:"sticky top-0 bg-[#0f0f0f] border-b border-gray-800 p-4 mb-4 flex items-center justify-between z-10",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-cyan-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z"})}),"AI Recommendations"]}),e.jsx("button",{onClick:()=>Ye(!1),className:"text-gray-400 hover:text-white p-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx(Ns,{currentStep:c===2?"audience":c===3?"formats":c===4?"budget":"overview",recommendations:me,onAddRecommendation:s=>{ls(s)},selectedItems:is(),isLoading:De})]})})]}),c!==5&&e.jsx(yt,{planData:{audiences:t.selectedPersonas,geographies:t.selectedStates.length>0?t.selectedStates:["Nationwide"],formats:t.selectedFormats,sites:t.selectedSites,totalBudget:parseInt(t.totalBudget)||0},onGeneratePlan:()=>z(6),isComplete:xt()}),Ds&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-700 rounded-lg p-6 max-w-lg w-full mx-4 shadow-2xl",children:[e.jsx("h3",{className:"text-white font-bold text-lg mb-4",children:"Save Changes"}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"This campaign already exists. Would you like to overwrite it or save as a new version?"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"New Version Name (optional)"}),e.jsx("input",{type:"text",value:Me,onChange:s=>xe(s.target.value),placeholder:`${t.campaignName} (v2)`,className:"w-full px-4 py-2 bg-[#0f0f0f] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyan-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to use auto-generated name"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:()=>{Pe(Qe,!0)},className:"flex-1 px-6 py-3 bg-gradient-to-r from-cyan-500 to-purple-600 hover:from-cyan-600 hover:to-purple-700 text-white rounded-lg font-semibold transition-all",children:"Save as New Version"}),e.jsx("button",{onClick:()=>{Pe(Qe,!1)},className:"flex-1 px-6 py-3 bg-amber-600 hover:bg-amber-700 text-white rounded-lg font-semibold transition-colors",children:"Overwrite Existing"}),e.jsx("button",{onClick:()=>{he(!1),xe("")},className:"px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})}),Ms&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-700 rounded-lg p-6 max-w-md w-full mx-4 shadow-2xl",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold mb-2",children:"Campaign saved as draft!"}),e.jsx("p",{className:"text-gray-400 text-sm",children:'You can continue editing later from the "Campaign Plans" page.'})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>$e(!1),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"OK"})})]})}),Fs&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-[#1a1a1a] border border-green-700 rounded-lg p-6 max-w-md w-full mx-4 shadow-2xl",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold mb-2",children:"Booking submitted successfully!"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Your booking has been sent to the sales team. They will contact you shortly to confirm."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>Oe(!1),className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"OK"})})]})}),As&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-[#1a1a1a] border border-amber-700 rounded-lg p-6 max-w-md w-full mx-4 shadow-2xl",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold mb-2",children:"Data Cleared"}),e.jsx("p",{className:"text-gray-400 text-sm",children:Ps}),e.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"Please re-select them in Step 4."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>Bs(!1),className:"px-6 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg transition-colors",children:"Got it"})})]})}),Cs&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#1a1a1a] border border-cyan-700 rounded-xl p-6 max-w-md w-full shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Save Audience Group"}),e.jsxs("p",{className:"text-gray-400 text-sm mb-4",children:["Save your current audience selection (",t.selectedPersonas.length," personas) for reuse in future campaigns."]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Group Name"}),e.jsx("input",{type:"text",value:de,onChange:s=>we(s.target.value),placeholder:"e.g., Tech-Savvy Millennials",className:"w-full px-4 py-2 bg-[#0f0f0f] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500",autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{je(!1),we("")},className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white text-sm font-medium rounded-lg transition-colors",disabled:Ne,children:"Cancel"}),e.jsx("button",{onClick:Us,disabled:Ne||!de.trim(),className:"flex-1 px-4 py-2 bg-gradient-to-r from-cyan-500 to-cyan-600 hover:from-cyan-600 hover:to-cyan-700 text-white text-sm font-medium rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:Ne?"Saving...":"Save Group"})]})]})}),Ee&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#1a1a1a] border border-purple-700 rounded-xl p-6 max-w-2xl w-full shadow-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Load Saved Audience"}),e.jsx("button",{onClick:()=>X(!1),className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),We?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Loading saved groups..."})]})}):ce.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("h4",{className:"text-lg font-semibold text-white mb-2",children:"No Saved Audiences"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Save your first audience group to reuse it in future campaigns."})]}):e.jsx("div",{className:"overflow-y-auto flex-1 space-y-3",children:ce.map(s=>e.jsxs("div",{className:"bg-[#0f0f0f] border border-gray-800 hover:border-purple-700 rounded-lg p-4 transition-all cursor-pointer group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-1",children:s.name}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-400",children:[e.jsxs("span",{children:[s.personas.length," personas"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[((s.uniqueReach||0)/1e6).toFixed(2),"M reach"]}),s.source&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"capitalize",children:s.source.replace("_"," ")})]})]})]}),e.jsx("button",{onClick:a=>{a.stopPropagation(),Ys(s.id)},className:"p-2 bg-red-900/20 hover:bg-red-900/40 border border-red-700 hover:border-red-600 text-red-400 hover:text-red-300 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:"Delete group",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.personas.slice(0,3).map((a,r)=>e.jsx("span",{className:"px-2 py-1 bg-purple-900/20 border border-purple-700/50 rounded text-xs text-purple-300",children:a},r)),s.personas.length>3&&e.jsxs("span",{className:"px-2 py-1 bg-gray-800 border border-gray-700 rounded text-xs text-gray-400",children:["+",s.personas.length-3," more"]})]})}),(s.industry||s.objective)&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-3",children:[s.industry&&e.jsx("span",{className:"text-gray-400",children:s.industry}),s.industry&&s.objective&&e.jsx("span",{children:"â€¢"}),s.objective&&e.jsx("span",{className:"text-gray-400",children:s.objective})]}),e.jsx("button",{onClick:()=>qs(s),className:"w-full px-4 py-2 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white text-sm font-medium rounded-lg transition-all",children:"Load This Audience"})]},s.id))})]})}),Ts&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:`bg-[#1a1a1a] border rounded-lg p-6 max-w-md w-full mx-4 shadow-2xl ${O.type==="danger"?"border-red-700":O.type==="warning"?"border-amber-700":"border-blue-700"}`,children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:O.type==="danger"?e.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}):O.type==="warning"?e.jsx("svg",{className:"w-6 h-6 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}):e.jsx("svg",{className:"w-6 h-6 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold mb-2",children:O.title}),e.jsx("p",{className:"text-gray-400 text-sm whitespace-pre-line",children:O.message})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[O.cancelText&&e.jsx("button",{onClick:O.onCancel,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors",children:O.cancelText}),O.confirmText&&e.jsx("button",{onClick:O.onConfirm,className:`px-6 py-2 rounded-lg transition-colors text-white ${O.type==="danger"?"bg-red-600 hover:bg-red-700":O.type==="warning"?"bg-amber-600 hover:bg-amber-700":"bg-blue-600 hover:bg-blue-700"}`,children:O.confirmText})]})]})})]})})}export{Et as default};
