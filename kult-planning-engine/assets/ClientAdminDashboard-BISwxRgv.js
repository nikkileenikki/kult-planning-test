import{j as e}from"./index-C1JaId44.js";import{d as A,r as l}from"./vendor-7lAwbL4C.js";import{a as n}from"./utils-B9ygI19o.js";import{L as z}from"./Layout-BIIFe71_.js";function R(){const o=A(),[M,j]=l.useState(null),[h,f]=l.useState([]),[p,v]=l.useState([]),[y,g]=l.useState(!0),[m,w]=l.useState({total:0,pending:0,approved:0,booked:0});l.useEffect(()=>{k(),d()},[]);const k=async()=>{const t=localStorage.getItem("token");try{const s=await n.get("/api/auth/me",{headers:{Authorization:`Bearer ${t}`}});j(s.data.user)}catch(s){console.error("Failed to load user:",s),o("/login")}},d=async()=>{const t=localStorage.getItem("token");try{g(!0);const s=await n.get("/api/campaign-workflow/my-campaigns",{headers:{Authorization:`Bearer ${t}`}}),a=await n.get("/api/campaign-workflow/pending-approval",{headers:{Authorization:`Bearer ${t}`}}),r=s.data.campaigns||[],c=a.data.campaigns||[];f(r),v(c);const x={total:r.length,pending:c.length,approved:r.filter(i=>i.status==="approved").length,booked:r.filter(i=>i.status==="booked").length};w(x)}catch(s){console.error("Failed to load dashboard data:",s)}finally{g(!1)}},N=async t=>{const s=localStorage.getItem("token");try{await n.post(`/api/campaign-workflow/${t}/approve`,{},{headers:{Authorization:`Bearer ${s}`}}),alert("Campaign approved successfully!"),d()}catch(a){console.error("Failed to approve campaign:",a),alert("Failed to approve campaign")}},C=async t=>{const s=prompt("Please provide a reason for rejection:");if(!s)return;const a=localStorage.getItem("token");try{await n.post(`/api/campaign-workflow/${t}/reject`,{reason:s},{headers:{Authorization:`Bearer ${a}`}}),alert("Campaign rejected"),d()}catch(r){console.error("Failed to reject campaign:",r),alert("Failed to reject campaign")}},L=async t=>{if(!confirm("Are you sure you want to book this campaign? This will notify the assigned sales person."))return;const s=localStorage.getItem("token");try{await n.post(`/api/campaign-workflow/${t}/book`,{},{headers:{Authorization:`Bearer ${s}`}}),alert("Campaign booked successfully! Sales person has been notified."),d()}catch(a){console.error("Failed to book campaign:",a),alert("Failed to book campaign")}},B=async t=>{var c,x;const s=prompt("Enter team member email to reassign to:");if(!s)return;const a=prompt("Reason for reassignment:");if(!a)return;const r=localStorage.getItem("token");try{await n.post(`/api/campaign-workflow/${t}/reassign`,{newOwnerEmail:s,reason:a},{headers:{Authorization:`Bearer ${r}`}}),alert("Campaign reassigned successfully!"),d()}catch(i){console.error("Failed to reassign campaign:",i),alert(((x=(c=i.response)==null?void 0:c.data)==null?void 0:x.message)||"Failed to reassign campaign")}},u=t=>{const s={draft:{bg:"bg-gray-600",text:"Draft"},pending_approval:{bg:"bg-yellow-600",text:"Pending"},approved:{bg:"bg-green-600",text:"Approved"},rejected:{bg:"bg-red-600",text:"Rejected"},booked:{bg:"bg-blue-600",text:"Booked"},in_progress:{bg:"bg-purple-600",text:"In Progress"},live:{bg:"bg-cyan-600",text:"Live"},completed:{bg:"bg-gray-500",text:"Completed"}},a=s[t]||s.draft;return e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold text-white ${a.bg}`,children:a.text})},b=t=>new Intl.NumberFormat("en-MY",{style:"currency",currency:"MYR",minimumFractionDigits:0}).format(t);return y?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Loading dashboard..."})]})}):e.jsx(z,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Client Admin Dashboard"}),e.jsx("p",{className:"text-gray-400",children:"Manage your team's campaigns and approvals"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Total Campaigns"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:m.total})]}),e.jsx("svg",{className:"w-10 h-10 text-cyan-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})]})}),e.jsx("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Pending Approval"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-400",children:m.pending})]}),e.jsx("svg",{className:"w-10 h-10 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),e.jsx("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Approved"}),e.jsx("p",{className:"text-3xl font-bold text-green-400",children:m.approved})]}),e.jsx("svg",{className:"w-10 h-10 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]})}),e.jsx("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Booked"}),e.jsx("p",{className:"text-3xl font-bold text-blue-400",children:m.booked})]}),e.jsx("svg",{className:"w-10 h-10 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})})]}),p.length>0&&e.jsxs("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Pending Approvals"}),e.jsxs("span",{className:"bg-yellow-600 text-white px-3 py-1 rounded-full text-sm font-semibold",children:[p.length," Waiting"]})]}),e.jsx("div",{className:"space-y-4",children:p.map(t=>{var s,a;return e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-4 hover:border-cyan-500 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold text-lg mb-1",children:t.campaignName||"Untitled Campaign"}),e.jsxs("p",{className:"text-gray-400 text-sm mb-2",children:[t.advertiserName," â€¢ ",(s=t.industry)==null?void 0:s.replace("_"," ")]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:["Budget: ",e.jsx("span",{className:"text-white font-medium",children:b(t.totalBudget||0)})]}),e.jsxs("span",{className:"text-gray-400",children:["Submitted: ",e.jsx("span",{className:"text-white",children:new Date((a=t.workflow)==null?void 0:a.submittedAt).toLocaleDateString()})]})]})]}),u(t.status)]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>N(t.id),className:"flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 inline mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Approve"]}),e.jsxs("button",{onClick:()=>C(t.id),className:"flex-1 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 inline mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Reject"]}),e.jsxs("button",{onClick:()=>o(`/campaigns/${t.id}`),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors",children:[e.jsxs("svg",{className:"w-4 h-4 inline mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]})]})]},t.id)})})]}),e.jsxs("div",{className:"bg-[#0f1419] border border-gray-800 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"All Team Campaigns"}),e.jsxs("button",{onClick:()=>o("/build-plan-wizard"),className:"bg-cyan-600 hover:bg-cyan-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 inline mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create New"]})]}),h.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-400 mb-4",children:"No campaigns yet"}),e.jsx("button",{onClick:()=>o("/build-plan-wizard"),className:"bg-cyan-600 hover:bg-cyan-700 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Create Your First Campaign"})]}):e.jsx("div",{className:"space-y-3",children:h.map(t=>e.jsx("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-4 hover:border-cyan-500 transition-all",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-white font-semibold",children:t.campaignName||"Untitled Campaign"}),u(t.status)]}),e.jsxs("p",{className:"text-gray-400 text-sm mb-2",children:[t.advertiserName," â€¢ ",t.objective]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:["Budget: ",e.jsx("span",{className:"text-white",children:b(t.totalBudget||0)})]}),e.jsxs("span",{className:"text-gray-400",children:["Created: ",new Date(t.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[t.status==="approved"&&e.jsx("button",{onClick:()=>L(t.id),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"ðŸ“… Book"}),(t.status==="draft"||t.status==="rejected")&&e.jsx("button",{onClick:()=>o(`/build-plan-wizard?id=${t.id}`),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-medium transition-colors",children:"âœï¸ Edit"}),e.jsx("button",{onClick:()=>B(t.id),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors",title:"Reassign to another team member",children:"ðŸ”„ Reassign"}),e.jsxs("button",{onClick:()=>o(`/campaigns/${t.id}`),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors",children:[e.jsxs("svg",{className:"w-4 h-4 inline mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]})]})]})},t.id))})]})]})})}export{R as default};
